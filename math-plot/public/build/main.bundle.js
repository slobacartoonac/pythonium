(()=>{var t={296:t=>{function e(t,e,n){var o,i,r,s,a;function c(){var u=Date.now()-s;u<e&&u>=0?o=setTimeout(c,e-u):(o=null,n||(a=t.apply(r,i),r=i=null))}null==e&&(e=100);var u=function(){r=this,i=arguments,s=Date.now();var u=n&&!o;return o||(o=setTimeout(c,e)),u&&(a=t.apply(r,i),r=i=null),a};return u.clear=function(){o&&(clearTimeout(o),o=null)},u.flush=function(){o&&(a=t.apply(r,i),r=i=null,clearTimeout(o),o=null)},u}e.debounce=e,t.exports=e},453:t=>{var e;self,e=()=>(()=>{"use strict";var t={738:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.evaluate=e.builtIn=void 0;const o=n(403),i=n(215);e.builtIn={pi:Math.PI,e:Math.E},e.evaluate=function t(n,r={}){switch(!0){case n instanceof i.NoopExp:return 0;case n instanceof i.BinaryExp:let s=n;return function(t,e,n){switch(n){case o.TokenType.tok_op_plus:return t+e;case o.TokenType.tok_op_minus:return t-e;case o.TokenType.tok_op_multiply:return t*e;case o.TokenType.tok_op_devide:return t/e;case o.TokenType.tok_op_power:return Math.pow(t,e);case o.TokenType.tok_op_modulo:return t%e;default:throw new Error("Operation "+n+" unknown")}}(t(s.left,r),t(s.right,r),s.op);case n instanceof i.IdentifierExp:let a=n;return void 0!==r[a.value]?r[a.value]:void 0!==e.builtIn[a.value.toLowerCase()]?e.builtIn[a.value.toLowerCase()]:-1;case n instanceof i.NumberExp:return n.value;case n instanceof i.BracketsExp:return t(n.expression,r);case n instanceof i.NegateExp:return-t(n.expression,r);case n instanceof i.FunctionExp:let c=n;return function(t,e){switch(e){case i.FunctionType.sin:return Math.sin(t);case i.FunctionType.asin:return Math.asin(t);case i.FunctionType.sinh:return Math.sinh(t);case i.FunctionType.asinh:return Math.asinh(t);case i.FunctionType.cos:return Math.cos(t);case i.FunctionType.acos:return Math.acos(t);case i.FunctionType.cosh:return Math.cosh(t);case i.FunctionType.acos:return Math.acos(t);case i.FunctionType.acosh:return Math.acosh(t);case i.FunctionType.tan:return Math.tan(t);case i.FunctionType.atan:return Math.atan(t);case i.FunctionType.tanh:return Math.tanh(t);case i.FunctionType.atanh:return Math.atanh(t);case i.FunctionType.round:return Math.round(t);case i.FunctionType.floor:return Math.floor(t);case i.FunctionType.ceil:return Math.ceil(t);case i.FunctionType.abs:return Math.abs(t);case i.FunctionType.sqrt:return Math.sqrt(t);case i.FunctionType.exp:return Math.exp(t);case i.FunctionType.ln:case i.FunctionType.log:return Math.log(t);case i.FunctionType.log10:return Math.log10(t);case i.FunctionType.factorial:return(n=t)%1?function(t){for(var e=t+1,n=Math.pow(25,t),o=1;o<25;o++)n*=o/e++;return n}(n):function(t){var e=t;if(0===t||1===t)return 1;for(;t>1;)e*=--t;return e}(n);default:throw new Error("Function "+e+" unknown")}var n}(t(c.expression,r),c.func);default:return-1}}},403:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Token=e.TokenType=e.tokenize=e.setInput=e.NumVal=e.IdentifierStr=e.getTokenElement=e.getNextToken=e.CurTok=void 0;const o=n(896);function i(){return e.CurTok=d()}function r(){switch(e.CurTok){case l.tok_identifier:return new p(l.tok_identifier,s.Col,s.Line,e.IdentifierStr);case l.tok_number:return new p(l.tok_number,s.Col,s.Line,"",e.NumVal);default:return new p(e.CurTok,s.Col,s.Line)}}e.getNextToken=i,e.getTokenElement=r;let s,a=" ",c={Line:1,Col:0};function u(t){f=t,a="",c={Line:1,Col:0},e.CurTok=null}var l;function h(){let t=function(){let t=f.split(""),e=t.shift();return void 0===e?(f="\0",o.EOF):(f=t.join(""),e)}();return"\n"==t||"\r"==t?(c.Line++,c.Col=0):c.Col++,t}e.setInput=u,e.tokenize=function(t){u(t);let n=[];for(;e.CurTok!=l.tok_eof;)i(),n.push(r());return n},function(t){t.tok_eof="tok_eof",t.tok_identifier="tok_identifier",t.tok_number="tok_number",t.tok_op_plus="tok_op_plus",t.tok_op_minus="tok_op_minus",t.tok_op_multiply="tok_op_multiply",t.tok_op_devide="tok_op_devide",t.tok_op_power="tok_op_power",t.tok_op_modulo="tok_op_modulo",t.tok_open="tok_open",t.tok_close="tok_close",t.tok_op_factorial="tok_op_factorial",t.tok_open_close_abs="tok_open_close_abs"}(l=e.TokenType||(e.TokenType={}));class p{constructor(t,e,n,o="",i=0){this.tokenType=t,this.column=e,this.line=n,this.str=o,this.value=i}}e.Token=p;let f="";function d(){for(;(0,o.isspace)(a);)a=h();if(s=c,(0,o.isalpha)(a)){for(e.IdentifierStr=a;(0,o.isalnum)(a=h());)e.IdentifierStr+=a;return l.tok_identifier}if((0,o.isdigit)(a)||"."==a){let t="";do{t+=a,a=h()}while((0,o.isdigit)(a)||"."==a);return e.NumVal=(0,o.strtod)(t),l.tok_number}if("+"==a)return a=h(),l.tok_op_plus;if("-"==a)return a=h(),l.tok_op_minus;if("*"==a)return a=h(),l.tok_op_multiply;if("/"==a)return a=h(),l.tok_op_devide;if("^"==a)return a=h(),l.tok_op_power;if("%"==a)return a=h(),l.tok_op_modulo;if("!"==a)return a=h(),l.tok_op_factorial;if(["{","[","("].includes(a))return a=h(),l.tok_open;if(["}","]",")"].includes(a))return a=h(),l.tok_close;if("|"==a)return a=h(),l.tok_open_close_abs;if("#"==a){do{a=h()}while(a!=o.EOF&&"\n"!=a&&"\r"!=a);if(a!=o.EOF)return d()}if(a==o.EOF)return l.tok_eof;let t=a;throw a=h(),Error("Undefined token"+t+" ( "+t.charCodeAt(0)+" ) at: "+JSON.stringify(s))}},215:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getIndentifierTokens=e.parseProgram=e.FactorialExpCandidate=e.FunctionExp=e.BinaryExp=e.IdentifierExp=e.NumberExp=e.BracketsExp=e.NegateExp=e.NoopExp=e.Exp=e.functionList=e.FunctionType=void 0;const o=n(403);let i,r,s=0;function a(){return s++,i.length<=s?(s=i.length-1,new o.Token(o.TokenType.tok_eof,0,0)):(r=i[s],i[s])}function c(){return i[s]}function u(t){return c().tokenType===t}var l;function h(t){return e.functionList.includes(t.toLowerCase())}!function(t){t[t.sin=0]="sin",t[t.asin=1]="asin",t[t.sinh=2]="sinh",t[t.asinh=3]="asinh",t[t.cos=4]="cos",t[t.acos=5]="acos",t[t.cosh=6]="cosh",t[t.acosh=7]="acosh",t[t.tan=8]="tan",t[t.atan=9]="atan",t[t.tanh=10]="tanh",t[t.atanh=11]="atanh",t[t.round=12]="round",t[t.floor=13]="floor",t[t.ceil=14]="ceil",t[t.abs=15]="abs",t[t.sqrt=16]="sqrt",t[t.exp=17]="exp",t[t.log=18]="log",t[t.log10=19]="log10",t[t.ln=20]="ln",t[t.factorial=21]="factorial"}(l=e.FunctionType||(e.FunctionType={})),e.functionList=Object.keys(l);class p{}e.Exp=p,e.NoopExp=class extends p{};class f extends p{constructor(t){super(),this.expression=t}}e.NegateExp=f;class d extends p{constructor(t){super(),this.expression=t}}e.BracketsExp=d;class y extends p{constructor(t){super(),this.value=t}}e.NumberExp=y;class g extends p{constructor(t){super(),this.value=t}}e.IdentifierExp=g;class m extends p{constructor(t,e,n){super(),this.left=t,this.right=e,this.op=n}}e.BinaryExp=m;class _ extends p{constructor(t,e){super(),this.expression=t,this.func=e}}e.FunctionExp=_;class x extends p{}e.FactorialExpCandidate=x;class k extends p{constructor(t){super(),this.priority=function(t){return{[o.TokenType.tok_op_plus]:1,[o.TokenType.tok_op_minus]:1,[o.TokenType.tok_op_multiply]:2,[o.TokenType.tok_op_devide]:2,[o.TokenType.tok_op_modulo]:4,[o.TokenType.tok_op_power]:5}[t]}(t),this.op=t}}function v(t){var e,n;if(u(o.TokenType.tok_eof)||u(o.TokenType.tok_close))return null;if(t&&!(t instanceof k)&&function(t=c().tokenType){return[o.TokenType.tok_op_plus,o.TokenType.tok_op_minus,o.TokenType.tok_op_multiply,o.TokenType.tok_op_devide,o.TokenType.tok_op_modulo,o.TokenType.tok_op_power].includes(t)}()){var i=c().tokenType;return a(),i==o.TokenType.tok_op_multiply&&c().tokenType==o.TokenType.tok_op_multiply?(a(),new k(o.TokenType.tok_op_power)):new k(i)}if(u(o.TokenType.tok_op_minus))return a(),new f(v(t));if(u(o.TokenType.tok_op_plus))return a(),v(t);if(t){if(u(o.TokenType.tok_op_factorial))return a(),new x;if(!(t instanceof k))return new k(o.TokenType.tok_op_multiply)}if(u(o.TokenType.tok_open))return function(){a();let t=w();return a(),new d(t)}();if(u(o.TokenType.tok_open_close_abs)){a();const t=w(o.TokenType.tok_open_close_abs);return a(),new _(t,l.abs)}if(u(o.TokenType.tok_identifier)){let t=(null===(e=c())||void 0===e?void 0:e.str)||"";if(a(),h(t)){let e=t;return new _(v(),l[e])}return new g(t)}if(u(o.TokenType.tok_number)){let t=(null===(n=c())||void 0===n?void 0:n.value)||0;return a(),new y(t)}throw new Error("Unexpected token: "+c().tokenType+` at: (${c().column},${c().line})`)}function T(t){return t.findIndex((function(t){return t instanceof x}))}function w(t=null){let e=null,n=[];for(;!(u(o.TokenType.tok_eof)||u(o.TokenType.tok_close)||t===o.TokenType.tok_open_close_abs&&u(o.TokenType.tok_open_close_abs));)n.push(v(n[n.length-1]));let i=T(n);for(;i>-1;){const t=n[i-1];n.splice(i-1,2,new _(t,l.factorial)),i=T(n)}for(;n.length>1;){const t=(r=void 0,r=n.map((function(t){return t instanceof k?t.priority:0})),s=Math.max.apply(Math,r),r.indexOf(s)),e=n[t],o=n[t-1],i=n[t+1];n.splice(t-1,3,new m(o,i,e.op))}var r,s;return e=n[0],e||new y(0)}e.parseProgram=function(t){return i=(0,o.tokenize)(t),s=0,w()},e.getIndentifierTokens=function(t){i=(0,o.tokenize)(t);let e=new Set;for(const t of i)if(t.tokenType==o.TokenType.tok_identifier){if(h(t.str||""))continue;e.add(t.str)}return Array.from(e)}},896:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EOF=e.strtod=e.isalpha=e.isalnum=e.isdigit=e.isspace=void 0,e.isspace=function(t){return/\s/.test(t)||""==t},e.isdigit=function(t){return/[0-9]/.test(t)},e.isalnum=function(t){return/[a-zA-Z0-9]/.test(t)},e.isalpha=function(t){return/[a-zA-Z]/.test(t)},e.strtod=function(t){let e=parseFloat(t);return isNaN(e)?0:e},e.EOF="\0"}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}var o={};return(()=>{var t=o;Object.defineProperty(t,"__esModule",{value:!0}),t.getIndentifierTokens=t.parseProgram=t.evaluate=t.execute=void 0;const e=n(215);Object.defineProperty(t,"parseProgram",{enumerable:!0,get:function(){return e.parseProgram}}),Object.defineProperty(t,"getIndentifierTokens",{enumerable:!0,get:function(){return e.getIndentifierTokens}});const i=n(738);Object.defineProperty(t,"evaluate",{enumerable:!0,get:function(){return i.evaluate}});let r={};t.execute=function(t,n={}){let o="",s=0;try{let o=new e.NoopExp;r[t]?o=r[t]:(o=(0,e.parseProgram)(t),r[t]=o),s=(0,i.evaluate)(o,n)}catch(t){o=t.toString()}return{res:s,err:o}}})(),o})(),t.exports=e()}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function e(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function o(t,e,n,o){return o?{x:(e.x-t.x+(o.x-n.x))/2,y:(e.y-t.y+(o.y-n.y))/2}:{x:e.x-t.x,y:e.y-t.y}}function i(e,n,o,i){if(!i)return 1;if(!o)return 1;let r=t(e,o),s=t(n,i);return r<.01?1:s/r}function r(t,e,n,o){if(!o)return 0;let i=s(t,n);return s(e,o)-i}function s(t,e){let n=o(t,e);return Math.atan2(n.y,n.x)}function a(n,s){this.deadzone=s,this.clear();let a=null,c=null,u=null,l=null,h=null,p=0,f=!0,d=!1,y=!1;this.centerPosition={x:0,y:0},this.debug=!1,this.console_error=!1,this.throw_error=!1,this.last_error="",this.preventDefault=!0;const g=t=>{this.preventDefault&&t.preventDefault();const{top:e,left:n}=t.currentTarget.getBoundingClientRect();if(t.touches[1]&&t.touches[0]){let o={x:t.touches[0].clientX-n,y:t.touches[0].clientY-e},i={x:t.touches[1].clientX-n,y:t.touches[1].clientY-e};return this.centerPosition={x:(o.x+i.x)/2,y:(o.y+i.y)/2},_(o,i)}if(t.touches[0]){let o={x:t.touches[0].clientX-n,y:t.touches[0].clientY-e};return this.centerPosition={x:o.x,y:o.y},_(o)}return x(t)},m=t=>{this.preventDefault&&t.preventDefault();const{top:e,left:n}=t.currentTarget.getBoundingClientRect();if(this.centerPosition={x:t.clientX-n,y:t.clientY-e},0!==t.buttons){if(p){if("drag"==t.type&&0==t.clientX&&0==t.clientY)return;_({x:t.clientX-n,y:t.clientY-e})}}else x(t)},_=(n,s)=>{if(d=!0,null==a)return a={x:n.x,y:n.y},c=+new Date,l={x:n.x,y:n.y},this.triger("start",l),void(f=!0);if(s&&null==u)return y=!0,t(a,s)<t(a,n)&&(a={x:n.x,y:n.y},c=+new Date,l={x:n.x,y:n.y}),u={x:s.x,y:s.y},void(h={x:s.x,y:s.y});if(!s&&u)return y=!1,u=null,void(h=null);let g=o(l,n,h,s),m=i(l,n,h,s),_=r(l,n,h,s);l={x:n.x,y:n.y},h=s?{x:s.x,y:s.y}:null;let x=o(a,l,u,h),k=i(a,l,u,h),v=e(x),T=r(a,l,u,h),w=+new Date-c,b=this.debug&&`${a&&"Start: "+JSON.stringify(a)},\n\t\t${l&&"This: "+JSON.stringify(l)}, \n\t\t${u&&"Start secound: "+JSON.stringify(u)}, \n\t\t${h&&"Start this: "+JSON.stringify(h)},\n\t\t${g&&"Delta: "+JSON.stringify(g)},\n\t\t${"Zoom: "+k},\n\t\t${"DZoom: "+m}\n\t\t${"Angle: "+T}\n\t\t${"DAngle: "+_}\n\t\t${"isPrimary: "+(!y&&0==p||1==p)}\n\t\t${this.last_error}`,S={delta:g,direction:x,startPosition:a,position:l,distance:v,click:f,isClick:f,mouseDown:p,zoom:k,deltaZoom:m,touchSecound:y,angle:T,deltaAngle:_,startTime:c,deltaTime:w,isPrimary:!y&&0==p||1==p,debug:b,centerPosition:this.centerPosition};this.triger("force",S),v>this.deadzone&&(f=!1,Math.abs(x.x)>Math.abs(x.y)?x.x>0?this.triger("right",S):this.triger("left",S):x.y>0?this.triger("down",S):this.triger("up",S))},x=t=>{if(this.preventDefault&&t.preventDefault(),0==d)return;let n={x:0,y:0},s=o(a,l,u,h),g=i(a,l,u,h),m=r(a,l,u,h),_=e(s),x=+new Date-c,k=this.debug&&`${a&&"Start: "+JSON.stringify(a)},\n\t\t${l&&"This: "+JSON.stringify(l)}, \n\t\t${u&&"Start secound: "+JSON.stringify(u)}, \n\t\t${h&&"Start this: "+JSON.stringify(h)},\n\t\t${n&&"Delta: "+JSON.stringify(n)},\n\t\t${"Zoom: "+g},\n\t\tDZoom: 0\n\t\t${"Angle: "+m}\n\t\tDAngle: 0\n\t\t${"isPrimary: "+(!y&&0==p||1==p)}\n\t\t${this.last_error}`;const v={x:a.x,y:a.y,delta:n,direction:s,startPosition:a,position:l,distance:_,click:f,isClick:f,mouseDown:p,zoom:g,deltaZoom:0,touchSecound:y,angle:m,deltaAngle:0,startTime:c,deltaTime:x,isPrimary:!y&&0==p||1==p,debug:k,centerPosition:this.centerPosition};d=!1,y=!1;let T=a;f&&(t.button&&(1===t.button&&this.triger("bmiddle",v),2===t.button&&this.triger("bright",v)),T&&this.triger("click",v)),this.triger("stop",v),a=null,c=null,l=null,u=null,h=null,p=0};n.addEventListener("touchmove",g,!1),n.addEventListener("touchend",x,!1),n.addEventListener("touchstart",g,!1),n.addEventListener("mouseleave",x,!1),n.addEventListener("mousemove",m),n.addEventListener("drag",m),n.addEventListener("mouseup",x),n.addEventListener("mousedown",(t=>{p=1+t.button,m(t)}))}function c(t,e,n,o,i,r,s){return[(r-t)*n+o/2,(s-e)*n+i/2]}function u(t,e,n,o,i,r,s){return[(r-o/2)/n+t,(s-i/2)/n+e]}function l(t){this.canvas=t,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.img=this.context.createImageData(this.canvas.width,this.canvas.height)}a.prototype.sub=function(t,e){this.events[t]&&this.events[t].push(e)},a.prototype.onClick=function(t){this.events.click.push(t)},a.prototype.onForce=function(t){this.events.force.push(t)},a.prototype.onStart=function(t){this.events.start.push(t)},a.prototype.onStop=function(t){this.events.stop.push(t)},a.prototype.onUp=function(t){this.events.up.push(t)},a.prototype.onDown=function(t){this.events.down.push(t)},a.prototype.onLeft=function(t){this.events.left.push(t)},a.prototype.onRight=function(t){this.events.right.push(t)},a.prototype.unsub=function(t,e){this.events[t]&&(this.events[t]=this.events[t].filter((t=>t!==e)))},a.prototype.clearEvlent=function(t){this.events[t]&&(this.events[t]=[])},a.prototype.clear=function(){this.events={up:[],down:[],left:[],right:[],stop:[],start:[],click:[],force:[],bmiddle:[],bright:[]}},a.prototype.triger=function(t,e){this.events[t]&&this.events[t].forEach((t=>{try{t(e)}catch(t){if(this.console_error&&console.log(t),this.last_error="Error: "+t.name+" "+t.foo+" "+t.message+" "+t.stack,this.throw_error)throw t}}))},l.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},l.prototype.getCanvas=function(){return this.canvas},l.prototype.worldToScreen=function(t,e){const{width:n,height:o}=this.canvas,{x:i,y:r,scale:s}=t;return c(i,r,s,n,o,e[0],e[1])},l.prototype.screenToWorld=function(t,e){const{width:n,height:o}=this.canvas,{x:i,y:r,scale:s}=t;return u(i,r,s,n,o,e[0],e[1])};const h=l;function p(t,e){this.context=t,this.showCords=e?.showCords,this.showAxis=e?.showAxis,this.axisCords=e?.axisCords,this.axisScale=e?.axisScale||100,this.devide=e?.devide||2}p.prototype.draw=function(t,e,n){const{context:o}=this;var i=o.canvas.clientWidth,r=o.canvas.clientHeight;const{x:s,y:a,scale:l}=n,h=i/2,p=r/2;for(var f=l||1;f>2;)f/=2;for(;f<1;)f*=2;const d=t*f,y=e*f;var g;if((k=(h-s*l)%d)<0&&(k+=d),(v=(p-a*l)%y)<0&&(v+=y),this.showAxis){o.beginPath();let[t,e]=c(s,a,l,i,r,0,0);o.lineWidth=2,o.moveTo(t,0),o.lineTo(t,r),o.moveTo(0,e),o.lineTo(i,e),o.strokeStyle="rgba(0, 0, 0, 1.0)",o.stroke()}o.beginPath();for(var m=k;m<=i;m+=d){if(o.moveTo(m,0),o.lineTo(m,r),!this.axisCords)continue;let t=u(s,a,l,i,r,m,0)[0];this.drawCod(t,0,n,o)}for(var _=v;_<=r;_+=y){if(o.moveTo(0,_),o.lineTo(i,_),!this.axisCords)continue;let t=u(s,a,l,i,r,0,_)[1];this.drawCod(0,t,n,o)}o.lineWidth=2,o.strokeStyle="rgba(128, 128, 128, 0.5)",o.stroke();for(var x=0;x<this.devide-1;x++){var k=(k+d/this.devide)%d,v=(v+y/this.devide)%y;for(o.beginPath(),m=k;m<=i;m+=d)o.moveTo(m,0),o.lineTo(m,r);for(_=v;_<=r;_+=y)o.moveTo(0,_),o.lineTo(i,_);o.lineWidth=1,o.strokeStyle="rgba(128, 128, 128, "+(.25*(1-(g=f-1))+.5*g)+")",o.stroke()}this.showCords&&(o.font="10px Arial",o.fillText(Math.round(n.x*this.axisScale)/this.axisScale+Number.EPSILON+","+Math.round(n.y*this.axisScale+Number.EPSILON)/this.axisScale+","+Math.round(n.scale*this.axisScale+Number.EPSILON)/this.axisScale,10,50))},p.prototype.drawCod=function(t,e,n,o){const{x:i,y:r,scale:s}=n;var a=o.canvas.clientWidth,c=o.canvas.clientHeight,u=(t-i)*s+a/2,l=(e-r)*s+c/2;let h=!1;function p(t){return+parseFloat(t).toFixed(2)}(u<5||u>a-19||l>c-28||l<14)&&(h=!0),u<5&&(u=5),l<14&&(l=14),u>a-19&&(u=a-19),l>c-28&&(l=c-28),o.font="14px Verdana",o.fillStyle="rgb(0, 0, 0, 1.0)";let f="",d=p(t/this.axisScale),y=p(-e/this.axisScale);d&&(f+=d),y&&(f+=y),y||d||h||(f+="0"),o.fillText(f,u+5,l+14)},p.prototype.line=function(t,e,n,o,i){this.context.lineWidth=1,this.context.moveTo(t,e),this.context.lineTo(t+n,e+o),this.context.strokeStyle=i,this.context.stroke()};const f=p;function d(t){this.context=t,this.scale=100}d.prototype.draw=function(t,e,n){const{context:o}=this;var i=o.canvas.clientWidth,r=o.canvas.clientHeight;const{x:s,y:a,scale:c}=t,u=i/2,l=r/2;var h=(-s*c+u)%2;o.beginPath(),o.moveTo(p,0);for(var p=h;p<=i;p+=2){var f=(-e(((p-u)/c+s)/this.scale)*this.scale-a)*c+l;isNaN(f)||(f>r+5&&(f=r+5),f<-5&&(f=-5),o.lineTo(p,f))}o.lineWidth=2;const d="string"==typeof n?n:`rgba(${n>>16&255}, ${n>>8&255}, ${255&n}, 1)`;o.strokeStyle=d||"rgba(0, 0, 0, 1)",o.stroke()};const y=d;var g=n(453);const m=[16711680,65280,255,16776960,16711935,65535];class _{constructor(t,e){this.funcArr=[],this.setProgram=t=>{this.funcArr=[],t.split(/[\\;\n]+/).map((t=>t.trim())).filter((t=>t.length>0)).forEach((t=>this.addFunction(t)))},this.addFunction=t=>{let e=(0,g.getIndentifierTokens)(t),n=(0,g.parseProgram)(t);this.funcArr.push((t=>{let{res:o,err:i}=this.eval(n,{[e[0]]:t});return i?(this.input.setBaloonText(i),console.log(i)):this.input.setBaloonText(""),o}))},this.work=function(t){this.funcArr.forEach(((e,n)=>this.fPloter.draw(t,e,m[n%m.length])))},this.draw=t,this.input=e,this.fPloter=new y(t.context),this.funcArr=[]}eval(t,e){try{return{res:(0,g.evaluate)(t,e),err:null}}catch(t){return{res:null,err:t.message}}}}function x(){const t=[...arguments];if(Array.call(this),1==t.length){var e=Object.values(t[0]);this.push(...e)}else this.push(...Object.values(t));Object.defineProperty(this,"length",{enumerable:!1,writable:!0})}function k(t,e){x.call(this),this.push(0,0,1,0),this.screen=t,Object.assign(this,e||{})}function v(){return 1+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}function T(t){this.id=t||v()}function w(t,e){T.call(this,t),this._manager=e}function b(t){this._entities=new Map,this._components=new Map,this._nice=!!t}function S(t){this.positions=new x(t)}function E(t,e){this.font=t,this.text=e}function O(t,e){this.x=t,this.y=e}function P(t){this.radius=t}function M(t){this.image=t}function N(t){this.radius=t}function F(t){this.rotate=t}function j(){this.noscale=!0}function C(t){this.scale=t}function I(t,e,n){this.image=t,this.x=e,this.y=n}function A(){}function L(t){this.to=t}function W(t,e,n){this.color=t,this.stroke=e,this.layer=n||0}function D(t,e){this.context=t,this.manager=e,this.maxSize=100}function $(t,e){e.color&&(t.fillStyle=e.color,t.fill()),e.stroke&&(t.strokeStyle=e.stroke.color,t.lineWidth=e.stroke.width,t.stroke())}function z(t,e,n,o,i,r){t.moveTo(e,n+r),t.lineTo(e,n+i-r),t.arcTo(e,n+i,e+r,n+i,r),t.lineTo(e+o-r,n+i),t.arcTo(e+o,n+i,e+o,n+i-r,r),t.lineTo(e+o,n+r),t.arcTo(e+o,n,e+o-r,n,r),t.lineTo(e+r,n),t.arcTo(e,n,e,n+r,r)}function X(){this.isSelected=!1,this.index=0}x.from=function(t){return new x(t)},x.prototype.x=0,x.prototype.y=0,x.prototype.z=0,x.prototype=Object.create(Array.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0,iterable:!0}}),x.prototype.constructor=x,x.prototype.add=function(t){let e=this.copy();for(var n in e)Object.hasOwnProperty.call(t,n)&&(e[n]+=t[n]);return e},Object.defineProperty(x.prototype,"add",{enumerable:!1}),Object.defineProperty(x.prototype,"x",{get(){return this[0]},set(t){this[0]=t}}),Object.defineProperty(x.prototype,"y",{get(){return this[1]},set(t){this[1]=t}}),Object.defineProperty(x.prototype,"z",{get(){return this[2]},set(t){this[2]=t}}),Object.defineProperty(x.prototype,"length",{enumerable:!1,writable:!0}),x.prototype.update=function(t){let e=Object.entries(t);for(var n=0;n<e.length;n++){let t=e[n];Object.hasOwnProperty.call(this,t[0])&&(this[n]=t[1])}},Object.defineProperty(x.prototype,"update",{enumerable:!1}),x.prototype.negate=function(){let t=this.copy();for(var e in this)t[e]=-t[e];return t},Object.defineProperty(x.prototype,"negate",{enumerable:!1}),x.prototype.substract=function(t){return this.add(t.negate())},Object.defineProperty(x.prototype,"substract",{enumerable:!1}),x.prototype.magnitude=function(){let t=0;for(var e of this)t+=e*e;return Math.sqrt(t)},Object.defineProperty(x.prototype,"magnitude",{enumerable:!1}),x.prototype.normalise=function(t){let e=this.magnitude();return e?this.scale(1/e):this.scale(0)},Object.defineProperty(x.prototype,"normalise",{enumerable:!1}),x.prototype.scale=function(t){let e=this.copy();for(var n in this)e[n]*=t;return e},Object.defineProperty(x.prototype,"scale",{enumerable:!1}),x.prototype.copy=function(){return new x(this)},Object.defineProperty(x.prototype,"copy",{enumerable:!1}),k.prototype=Object.create(x.prototype),k.prototype.constructor=k,k.prototype.zoom=function(t,e,n){if(this.scale*=t,!isNaN(this.minScale)&&this.scale<this.minScale)this.scale=this.minScale;else if(!isNaN(this.maxScale)&&this.scale>this.maxScale)this.scale=this.maxScale;else if(void 0!==e&&void 0!==n){let o=t-1,i=(this.screen.width/2-e)*o,r=(this.screen.height/2-n)*o;this.move(i,r)}},k.prototype.rotate=function(t){this.angle+=t,this.saveToLocalStorage()},k.prototype.move=function(t,e){let n=t/this.scale,o=e/this.scale;this.x-=n,this.y-=o,!isNaN(this.minX)&&this.x<this.minX&&(this.x=this.minX),!isNaN(this.maxX)&&this.x>this.maxX&&(this.x=this.maxX),!isNaN(this.minY)&&this.y<this.minY&&(this.y=this.minY),!isNaN(this.maxY)&&this.y>this.maxY&&(this.y=this.maxY),this.saveToLocalStorage()},k.prototype.loadFromLocalStorage=function(t){this.localStorageKey=t;let e=localStorage.getItem(this.localStorageKey);if(e){let t=JSON.parse(e);this[0]=t[0]||0,this[1]=t[1]||0,this[2]=t[2]||1,this[3]=t[3]||0}},k.prototype.saveToLocalStorage=function(){this.localStorageKey&&localStorage.setItem(this.localStorageKey,JSON.stringify(this))},Object.defineProperty(k.prototype,"scale",{get(){return this[2]},set(t){this[2]=t}}),Object.defineProperty(k.prototype,"angle",{get(){return this[3]},set(t){this[3]=t}}),w.prototype=Object.create(T.prototype),w.prototype.constructor=w,w.prototype.get=function(t){return this._manager.get(t,this)},w.prototype.has=function(t){return this._manager.get(t,this).length>0},w.prototype.assign=function(t){this._manager.assign(t,this)},w.prototype.remove=function(t){this._manager.remove(t,this)},w.prototype.destroy=function(){this._manager.destroy(this)},b.prototype.create=function(){if(this._nice)return this.create_nice();var t=this.make_entity();return this._entities.set(t.id,t),t},b.prototype.create_nice=function(){var t=this.make_entity_nice();return this._entities.set(t.id,t),t},b.prototype.make_entity=function(){return new T},b.prototype.make_entity_nice=function(){return new w(void 0,this)},b.prototype.alive=function(t){return this._entities.has(t.id)},b.prototype.destroy=function(t){this._entities.delete(t.id),this._components.forEach((e=>{e.has(t.id)&&e.delete(t.id)}))},b.prototype.asign=function(t,e){if(!e)throw Error("Can't asign to "+e);if(!(e instanceof T))throw Error(e+" is not Entity");if(!this._entities.get(e.id))throw Error(e+" not Entity form this set");var n=t.constructor.name,o=this._components.get(n);if(!o){let o=new Map;return o.set(e.id,new Set([t])),void this._components.set(n,o)}let i=o.get(e.id);if(i){if(i.has(t))throw Error("Component is allready asiged");i.add(t)}else o.set(e.id,new Set([t]))},b.prototype.assign=b.prototype.asign,b.prototype.get=function(t,e){var n=this._components.get(t.name);if(!n)return[];var o=n.get(e.id);return o?Array.from(o):[]},b.prototype.remove=function(t,e){var n=this._components.get(t.constructor.name);if(n){var o=n.get(e.id);o&&o.delete(t)}},b.prototype.getEnities=function(t){if(!this._components.has(t.name))return[];const e=[];return this._components.get(t.name).forEach(((t,n)=>{t&&t.size&&e.push(this._entities.get(n))})),e},b.prototype.toString=function(){const t=new WeakSet,e=new WeakMap;let n=Array.from(this._components.entries()).map((([t,e])=>[t,Array.from(e.entries()).map((([t,e])=>[t,Array.from(e)]))]));return JSON.stringify(n,(function(n,o){if(o&&"object"==typeof o){if(Array.isArray(o))return o;let n=o;return o instanceof Array&&(e.has(o)?n=e.get(o):(n={__forceType:o.constructor.name,data:o.slice()},e.set(o,n))),t.has(n)?Object.assign({},n):(t.add(n),n.__type=o.constructor.name,n.__id=v(),n)}return o}))},b.fromString=function(t,e){let n=e.map((t=>[t.name,t]));const o=new Map(n),i=new Map;Object.assign(o,{Map});let r=JSON.parse(t,(function(t,e){if(e&&"object"==typeof e&&e.__type){const t=e.__forceType||e.__type;if(o.has(t)){const r=o.get(t);if(i.has(e.__id))return i.get(e.__id);var n=e.__forceType?e.data:e;if(Array.isArray(n)){let t=n;(n=Object.create(r.prototype)).push(...t)}else Object.setPrototypeOf(n,r.prototype);let s=e.__id;return delete e.__type,delete e.__id,delete e.__forceType,i.set(s,n),n}throw new Error("No classMap provided for "+e.__type)}return e})).map((([t,e])=>[t,new Map(e.map((([t,e])=>[t,new Set(e)])))])),s=new Map(r),a=new Set,c=a.add.bind(a);s.forEach((t=>{[...t.keys()].forEach(c)}));let u=new b,l=new Map([...a.values()].map((t=>[t,new T(t,u)])));return Object.assign(u,{_components:s}),Object.assign(u,{_entities:l}),u},A.render=function(t,e,n,o,i){for(let r=0;r<n;r+=i)for(let s=0;s<e;s+=o){let a=Math.min(o,e-s),c=Math.min(i,n-r);this.context.drawImage(t,s,r,a,c)}},D.prototype.draw=function(t){const{context:e}=this;var n=e.canvas.clientWidth,o=e.canvas.clientHeight;const{x:i,y:r,scale:s,angle:a}=t,c=n/2,u=o/2,l=this.maxSize*s;a&&(e.save(),e.translate(c,u),e.rotate(a),e.translate(-c,-u));let h=this.manager.getEnities(W).map((t=>[t,this.manager.get(W,t)[0]])),p=new Map(h.map((([t])=>{var e=this.manager.get(S,t).reduce(((t,e)=>(t[0]+=e.positions[0],t[1]+=e.positions[1],t)),[0,0]);return[t,{x:(e[0]-i)*s+c,y:(e[1]-r)*s+u}]})));h.sort((([,t],[,e])=>t.layer<e.layer?-1:t.layer>e.layer?1:0)).map((([t,i])=>{let{x:r,y:a}=p.get(t);if(r<-l||a<-l||r>n||a>o)return;let c=this.manager.get(j,t)[0],u=this.manager.get(C,t)[0],h=c?1:s*(u?.scale||1),f=this.manager.get(P,t);for(let t in f){let n=f[t];const o=n.radius*h>1?n.radius*h:1;e.beginPath(),e.arc(r,a,o,0,2*Math.PI,!1),$(e,i)}let d=this.manager.get(O,t),y=this.manager.get(L,t),g=this.manager.get(N,t),m=this.manager.get(F,t)[0];for(let t in y){let n=y[t];if(!p.has(n.to))continue;let o=p.get(n.to);e.beginPath(),e.moveTo(r,a),e.lineTo(o.x,o.y),e.closePath(),$(e,i)}for(let t in d){let n=d[t];const o=n.x*h>1?n.x*h:1,s=n.y*h>1?n.y*h:1;e.save(),m&&(e.translate(r+o/2,a+s/2),e.rotate(m.rotate),e.translate(-r-o/2,-a-s/2)),e.beginPath(),g[0]?z(e,r,a,o,s,g[0].radius):e.rect(r,a,o,s),$(e,i),e.restore()}let _=this.manager.get(M,t);for(let t in _){let n=_[t],o=d[0],i=o?.x||n.image.width,s=o?.y||n.image.height;const c=i*h>1?i*h+.5:1,u=s*h>1?s*h+.5:1;e.save(),m&&(e.translate(r+c/2,a+u/2),e.rotate(m.rotate),e.translate(-r-c/2,-a-u/2)),e.drawImage(n.image,r,a,c,u),e.restore()}this.manager.get(I,t).forEach((t=>{let n=d[0],o=n?.x||t.image.width,i=n?.y||t.image.height;const s=o*h>1?o*h+.5:1,c=s/o,u=i*h>1?i*h+.5:1;e.save(),m&&(e.translate(r+s/2,a+u/2),e.rotate(m.rotate),e.translate(-r-s/2,-a-u/2)),e.translate(r,a),A.render.call(this,t.image,s,u,t.x*c,t.y*c,e),e.restore()}));let x=this.manager.get(E,t);for(let t in x){let n=x[t];const o=n.font*h>1?n.font*h:1;e.fillStyle=i.color,e.font=parseInt(o)+"px serif",e.save(),m&&(e.translate(r,a),e.rotate(m.rotate),e.translate(-r,-a)),e.fillText(n.text,r,a+parseInt(o)),e.restore()}})),a&&e.restore()},D.prototype.mesure=function(t){const{context:e}=this;return e.font=parseInt(t.font)+"px serif",e.measureText(t.text)};const J=(t,e,n,o,i,r,s)=>{let a=t.create();return t.asign(new S([e,n]),a),t.asign(new O(o,i),a),t.asign(new W(r,s),a),t.asign(new N(5),a),a};function Y(t,e){let n=t.split(/\r?\n/),o=[];for(let t of n){if(t.length<e){o.push(t);continue}let n=t.split(" "),i="";for(let t of n)t.length>e&&(t=t.slice(0,e-4),t+="..."),i.length+t.length>e&&(o.push(i.slice(1)),i=""),i+=" "+t;i.length&&o.push(i.slice(1))}return o}function B(){}function H(t,...e){e.forEach((e=>t.asign(new B,e)))}function Z(t){this.checked=t}class q{}class R{constructor(t){this.ploter=t,this.manager=new b,this.render=new D(this.ploter.context,this.manager),this.input_position=new k(t.canvas),this.stabilex=30,this.stabiley=30,this.inputs={},this.baloonText=""}getWith(){return this.ploter.canvas.width}getHeight(){return this.ploter.canvas.height}setResolution(){this.input_position.x=this.getWith()/2,this.input_position.y=this.getHeight()/2}touchClick({x:t,y:e}){var n=this.ploter.screenToWorld(this.input_position,[t,e]);const o=this.manager.getEnities(X).map((t=>{var e=this.manager.get(S,t)[0],n=this.manager.get(O,t)[0],o=this.manager.get(X,t)[0];return o.index=0,{transform:e,box:n,selectable:o,id:t}})).filter((({transform:t,box:e})=>function(t,e,n){return!(t[0]>n[0]||t[1]>n[1]||t[0]+e[0]<n[0]||t[1]+e[1]<n[1])}(t.positions,[e.x,e.y],n)))[0];if(o){let t=this.manager.get(Z,o.id)[0];t&&this.setState(o.id,!t.checked)}return o}addTogle(t){let e=new E(20,t),n=this.render.mesure(e).width,o=this.manager.create();this.manager.asign(new S([this.stabilex,this.stabiley]),o),this.manager.asign(new O(n+10,30),o),this.manager.asign(new W("#555555"),o),this.manager.asign(new X,o),this.manager.asign(new Z(!1),o),this.all.push(o);let i=this.manager.create();return this.manager.asign(new S([this.stabilex+5,this.stabiley]),i),this.manager.asign(e,i),this.manager.asign(new W("#cccccc"),i),this.all.push(i),this.stabilex+=n+15,this.inputs[t]=o,o}getCheckedByText(t){if(!this.inputs[t])return!1;let e=this.manager.get(Z,this.inputs[t])[0];return!!e&&e.checked}setState(t,e){let n=this.manager.get(W,t)[0];n&&(n.color=e?"#888888":"#555555");let o=this.manager.get(Z,t)[0];o&&(o.checked=e)}setBaloonText(t){if(this.baloonText==t)return;if(this.baloonText=t,this.manager.getEnities(q).forEach((t=>{this.manager.destroy(t)})),!this.baloonText)return;let e=function(t,e,n,o,i){let r=[],s=i?.textSize||20,a=i?.lineHeight||s+10,c=i?.background||"#ffffffaa",u=i?.borderColor||"#ffffff",l=i?.borderWidth||1,h=i?.anchor||[0,0],p=i?.paddingX||i?.padding||10,f=i?.paddingY||i?.padding||10,d=i?.minWidth||0,y=i?.minHeight||0,g=i?.maxWidth||0,m=0,_=o.split(/\r?\n/).map((t=>{let n=new E(s,t),o=e.mesure(n).width,i=o+2*p;if(!g||i<g)return m=Math.max(o,m),[n];for(let n=t.length-1;0<n;n--){let o=Y(t,n).map((t=>new E(s,t))),r=o.map((t=>e.mesure(t).width));if(i=Math.max(...r.map((t=>t+2*p))),i<g)return m=Math.max(m,...r),o}return[n]}));_=_.flat();let x=m+2*p;x=Math.max(d,x);let k=_.length*a+2*f;k=Math.max(y,k);let v=n[0]-x*h[0],T=n[1]-k*h[1],w=((t,e,n,o,i,r,s)=>{let a=s.width-1,c=J(t,e-a,n-a,o+2*a,i+2*a,null,{...s,width:a+2});return[J(t,e,n,o,i,r),c]})(t,v,T,x,k,c,{color:u,width:l});return r.push(...w),H(t,...w),_.map(((e,n)=>{let o=t.create();t.asign(new S([v+p,T+f+n*a]),o),t.asign(e,o),t.asign(new W("#000000",null,2),o),r.push(o),H(t,o)})),r}(this.manager,this.render,[this.getWith()-126,this.getHeight()-30],this.baloonText,{textSize:20,maxWidth:this.getWith()-136,minWidth:this.getWith()-136,anchor:[1,1],borderColor:"#aaaaaa",background:"#aaaaaaaa"});e.map((t=>this.manager.asign(new q,t)))}work(){this.render.draw(this.input_position)}}var K=n(296),V=n.n(K);const U=document.getElementById("phy_canvas");let{work:G,adjustWindowSize:Q}=function(t,e){var n=new h(t),o=new R(n),i=new k(t,{minX:-2e3,minY:-2e3,maxX:2e3,maxY:2e3,minScale:.15,maxScale:3}),r=new _(n,o),s=new a(t,20);s.throw_error=!0,window.addEventListener("mousewheel",(function(t){i.zoom(t.wheelDelta>0?1.1:.88,s.centerPosition.x,s.centerPosition.y)})),document.addEventListener("contextmenu",(function(t){t.preventDefault()}));let c=document.getElementById("program_text"),u=V()(r.setProgram,200);c.addEventListener("input",(t=>{u(t.target.value)}));const l=new f(n.context,{axisCords:!0,devide:4,showAxis:!0});let p=!1,d=!1;return s.onForce((t=>{var{delta:e,deltaZoom:n,isPrimary:o,centerPosition:r,position:s,isClick:a}=t;1!=n&&i.zoom(n,r.x,r.y),i.move(e.x,e.y)})),s.onStop((t=>{p=!1,d=!1})),s.onClick((t=>{o.touchClick(t)})),{work:function(){n.clear(),l.draw(100,100,i),r.work(i),o.work()},adjustWindowSize:function(){o.setResolution()}}}(U);window.addEventListener("resize",(()=>{U.width=window.innerWidth-10,U.height=window.innerHeight-10,Q()})),U.width=window.innerWidth-10,U.height=window.innerHeight-10,Q();let tt=()=>{G(),setTimeout(tt,0)};tt()})()})();