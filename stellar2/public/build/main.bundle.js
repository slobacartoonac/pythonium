(()=>{"use strict";var t,e,i,n,s,r,a={},o={};function h(t){var e=o[t];if(void 0!==e)return e.exports;var i=o[t]={id:t,loaded:!1,exports:{}};return a[t](i,i.exports,h),i.loaded=!0,i.exports}function c(t){this.id=t}function l(){this._generation={},this._free_indices=[],this._entities={},this._components={},this.__entities_with_type={}}function u(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function p(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function d(t,e,i,n){return n?{x:(e.x-t.x+(n.x-i.x))/2,y:(e.y-t.y+(n.y-i.y))/2}:{x:e.x-t.x,y:e.y-t.y}}function g(t,e,i,n){if(!n)return 1;if(!i)return 1;let s=u(t,i),r=u(e,n);return s<.01?1:r/s}function m(t,e,i,n){if(!n)return 0;let s=f(t,i);return f(e,n)-s}function f(t,e){let i=d(t,e);return Math.atan2(i.y,i.x)}function y(t,e){this.deadzone=e,this.clear();let i=null,n=null,s=null,r=null,a=0,o=!0,h=!1,c=!1;this.centerPosition={x:0,y:0},this.debug=!1,this.console_error=!1,this.throw_error=!1,this.last_error="";const l=t=>{t.preventDefault();const{top:e,left:i}=t.target.getBoundingClientRect();if(t.touches[1]&&t.touches[0]){let n={x:t.touches[0].clientX-i,y:t.touches[0].clientY-e},s={x:t.touches[1].clientX-i,y:t.touches[1].clientY-e};return this.centerPosition={x:(n.x+s.x)/2,y:(n.y+s.y)/2},y(n,s)}if(t.touches[0]){let n={x:t.touches[0].clientX-i,y:t.touches[0].clientY-e};return this.centerPosition={x:n.x,y:n.y},y(n)}},f=t=>{t.preventDefault();const{top:e,left:i}=t.target.getBoundingClientRect();this.centerPosition={x:t.clientX-i,y:t.clientY-e},a&&y({x:t.clientX-i,y:t.clientY-e})},y=(t,e)=>{if(h=!0,null==i)return i={x:t.x,y:t.y},s={x:t.x,y:t.y},this.triger("start",s),void(o=!0);if(e&&null==n)return c=!0,u(i,e)<u(i,t)&&(i={x:t.x,y:t.y},s={x:t.x,y:t.y}),n={x:e.x,y:e.y},void(r={x:e.x,y:e.y});if(!e&&n)return c=!1,n=null,void(r=null);let l=d(s,t,r,e),f=g(s,t,r,e),y=m(s,t,r,e);s={x:t.x,y:t.y},r=e?{x:e.x,y:e.y}:null;let v=d(i,s,n,r),x=g(i,s,n,r),w=p(v),b=m(i,s,n,r),M=this.debug&&`${i&&"Start: "+JSON.stringify(i)},\n\t\t${s&&"This: "+JSON.stringify(s)}, \n\t\t${n&&"Start secound: "+JSON.stringify(n)}, \n\t\t${r&&"Start this: "+JSON.stringify(r)},\n\t\t${l&&"Delta: "+JSON.stringify(l)},\n\t\t${"Zoom: "+x},\n\t\t${"DZoom: "+f}\n\t\t${"Angle: "+b}\n\t\t${"DAngle: "+y}\n\t\t${"isPrimary: "+(!c&&0==a||1==a)}\n\t\t${this.last_error}`,_={delta:l,direction:v,startPosition:i,position:s,distance:w,click:o,isClick:o,mouseDown:a,zoom:x,deltaZoom:f,touchSecound:c,angle:b,deltaAngle:y,isPrimary:!c&&0==a||1==a,debug:M,centerPosition:this.centerPosition};this.triger("force",_),w>this.deadzone&&(o=!1,Math.abs(v.x)>Math.abs(v.y)?v.x>0?this.triger("right",_):this.triger("left",_):v.y>0?this.triger("down",_):this.triger("up",_))},v=t=>{if(t.preventDefault(),0==h)return;let e={x:0,y:0},l=d(i,s,n,r),u=g(i,s,n,r),f=m(i,s,n,r),y=p(l),v=this.debug&&`${i&&"Start: "+JSON.stringify(i)},\n\t\t${s&&"This: "+JSON.stringify(s)}, \n\t\t${n&&"Start secound: "+JSON.stringify(n)}, \n\t\t${r&&"Start this: "+JSON.stringify(r)},\n\t\t${e&&"Delta: "+JSON.stringify(e)},\n\t\t${"Zoom: "+u},\n\t\tDZoom: 0\n\t\t${"Angle: "+f}\n\t\tDAngle: 0\n\t\t${"isPrimary: "+(!c&&0==a||1==a)}\n\t\t${this.last_error}`;const x={x:i.x,y:i.y,delta:e,direction:l,startPosition:i,position:s,distance:y,click:o,isClick:o,mouseDown:a,zoom:u,deltaZoom:0,touchSecound:c,angle:f,deltaAngle:0,isPrimary:!c&&0==a||1==a,debug:v,centerPosition:this.centerPosition};h=!1,c=!1;let w=i;o&&(t.button?(1===t.button&&this.triger("bmiddle",x),2===t.button&&this.triger("bright",x)):w&&this.triger("click",x)),this.triger("stop",x),i=null,s=null,n=null,r=null,a=0};t.addEventListener("touchstart",(t=>{t.preventDefault()}),!1),t.addEventListener("touchmove",l,!1),t.addEventListener("touchend",v,!1),t.addEventListener("touchstart",l,!1),t.addEventListener("mouseleave",v,!1),t.addEventListener("mousemove",f),t.addEventListener("mouseup",v),t.addEventListener("mousedown",(t=>{a=1+t.button,f(t)}))}h.m=a,t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",i="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=t=>{t&&!t.d&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},h.a=(s,r,a)=>{var o;a&&((o=[]).d=1);var h,c,l,u=new Set,p=s.exports,d=new Promise(((t,e)=>{l=e,c=t}));d[e]=p,d[t]=t=>(o&&t(o),u.forEach(t),d.catch((t=>{}))),s.exports=d,r((s=>{var r;h=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[t])return s;if(s.then){var r=[];r.d=0,s.then((t=>{a[e]=t,n(r)}),(t=>{a[i]=t,n(r)}));var a={};return a[t]=t=>t(r),a}}var o={};return o[t]=t=>{},o[e]=s,o})))(s);var a=()=>h.map((t=>{if(t[i])throw t[i];return t[e]})),c=new Promise((e=>{(r=()=>e(a)).r=0;var i=t=>t!==o&&!u.has(t)&&(u.add(t),t&&!t.d&&(r.r++,t.push(r)));h.map((e=>e[t](i)))}));return r.r?c:a()}),(t=>(t?l(d[i]=t):c(p),n(o)))),o&&(o.d=0)},h.d=(t,e)=>{for(var i in e)h.o(e,i)&&!h.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},h.f={},h.e=t=>Promise.all(Object.keys(h.f).reduce(((e,i)=>(h.f[i](t,e),e)),[])),h.u=t=>t+".bundle.js",h.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),h.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s={},r="stellar2:",h.l=(t,e,i,n)=>{if(s[t])s[t].push(e);else{var a,o;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var u=c[l];if(u.getAttribute("src")==t||u.getAttribute("data-webpack")==r+i){a=u;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,h.nc&&a.setAttribute("nonce",h.nc),a.setAttribute("data-webpack",r+i),a.src=t),s[t]=[e];var p=(e,i)=>{a.onerror=a.onload=null,clearTimeout(d);var n=s[t];if(delete s[t],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((t=>t(i))),e)return e(i)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),o&&document.head.appendChild(a)}},h.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},h.v=(t,e,i,n)=>{var s=fetch(h.p+""+i+".module.wasm");return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(s,n).then((e=>Object.assign(t,e.instance.exports))):s.then((t=>t.arrayBuffer())).then((t=>WebAssembly.instantiate(t,n))).then((e=>Object.assign(t,e.instance.exports)))},h.p="build/",(()=>{var t={179:0};h.f.j=(e,i)=>{var n=h.o(t,e)?t[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var s=new Promise(((i,s)=>n=t[e]=[i,s]));i.push(n[2]=s);var r=h.p+h.u(e),a=new Error;h.l(r,(i=>{if(h.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var s=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;a.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",a.name="ChunkLoadError",a.type=s,a.request=r,n[1](a)}}),"chunk-"+e,e)}};var e=(e,i)=>{var n,s,[r,a,o]=i,c=0;if(r.some((e=>0!==t[e]))){for(n in a)h.o(a,n)&&(h.m[n]=a[n]);o&&o(h)}for(e&&e(i);c<r.length;c++)s=r[c],h.o(t,s)&&t[s]&&t[s][0](),t[s]=0},i=self.webpackChunkstellar2=self.webpackChunkstellar2||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),c.prototype.index=function(){return 4194303&this.id},c.prototype.generation=function(){return this.id>>22&255},l.prototype.create=function(){var t=0;this._free_indices.length>0?t=this._free_indices.shift():(t=Object.keys(this._generation).length,this._generation[t]=0);var e=this.make_entity(t,this._generation[t]);return this._entities[t]=e,e},l.prototype.make_entity=function(t,e){return new c(t+(e<<22))},l.prototype.alive=function(t){return this._generation[t.index()]==t.generation()},l.prototype.destroy=function(t){this._components[t.id]=void 0,this._entities[t.id]=void 0,++this._generation[t.index()],this._free_indices.push(t.index())},l.prototype.asign=function(t,e){var i=this._components[e.id];if(i){var n=i[t.constructor.name];if(n){if(n&&i[t.constructor.name].find((e=>t===e)))throw Error("Component is allready asiged");i[t.constructor.name].push(t)}else this._components[e.id][t.constructor.name]=[t]}else this._components[e.id]={[t.constructor.name]:[t]}},l.prototype.get=function(t,e){var i=this._components[e.id];return i&&i[t.name]||[]},l.prototype.remove=function(t,e){var i=this._components[e.id];i&&i[t.constructor.name]&&(i[t.constructor.name]=i[t.constructor.name].filter((function(e){return e!==t})))},l.prototype.getEnities=function(t){return Object.values(this._entities).filter((e=>e&&this.get(t,e).length))},y.prototype.sub=function(t,e){this.events[t]&&this.events[t].push(e)},y.prototype.onClick=function(t){this.events.click.push(t)},y.prototype.onForce=function(t){this.events.force.push(t)},y.prototype.onStop=function(t){this.events.stop.push(t)},y.prototype.onUp=function(t){this.events.up.push(t)},y.prototype.onDown=function(t){this.events.down.push(t)},y.prototype.onLeft=function(t){this.events.left.push(t)},y.prototype.onRight=function(t){this.events.right.push(t)},y.prototype.unsub=function(t,e){this.events[t]&&(this.events[t]=this.events[t].filter((t=>t!==e)))},y.prototype.clearEvlent=function(t){this.events[t]&&(this.events[t]=[])},y.prototype.clear=function(){this.events={up:[],down:[],left:[],right:[],stop:[],start:[],click:[],force:[],bmiddle:[],bright:[]}},y.prototype.triger=function(t,e){this.events[t]&&this.events[t].forEach((t=>{try{t(e)}catch(t){if(this.console_error&&console.log(t),this.last_error="Error: "+t.name+" "+t.foo+" "+t.message+" "+t.stack,this.throw_error)throw t}}))};const v=y;function x(...t){if(Array.call(this),1==t.length){var e=t[0],i=Object.values(e);Object.hasOwnProperty.call(e,"length")&&e.length!==i.length&&i.pop(),this.push(...i)}else this.push(...Object.values(t));Object.defineProperty(this,"x",{get(){return this[0]},set(t){this[0]=t}}),Object.defineProperty(this,"y",{get(){return this[1]},set(t){this[1]=t}}),Object.defineProperty(this,"z",{get(){return this[2]},set(t){this[2]=t}})}function w(t){this.positions=new x(t)}function b(t,e,i){this.speeds=new x(t),this.mass=e,this.drag=isNaN(i)?.001:i,this.maxSpeed=100}function M(t,e){this.manager=t,this.engines=e}function _(t){this.radius=t}function S(){}function E(t){this.manager=t,this.physic_entity=null}function k(t,e){var i=[];return e.forEach((e=>{if(e!=t){var n=e.positions[0]-t.positions[0],s=e.positions[1]-t.positions[1],r=t.radius+e.radius;Math.abs(n)>r||Math.abs(s)>r||function(t,e){for(var i=0,n=0;n<t.positions.length;n++)i+=Math.pow(t.positions[n]-e.positions[n],2);return i}(t,e)>Math.pow(r,2)||t.radius>e.radius&&i.push(e)}})),i}function P(t,e){this.manager=t,this.interaction=e||.1}function O(t,e,i){var n=[0,0];return e.forEach((e=>{if(e!=t){var s=e.positions[0]-t.positions[0],r=e.positions[1]-t.positions[1],a=s*s+r*r,o=Math.sqrt(a),h=e.mass/a*i;n[0]+=s/o*h,n[1]+=r/o*h}})),n}function A(t,e){this.x=t,this.y=e}function D(t,e){this.font=t,this.text=e}function T(t){this.image=t}function N(t){this.radius=t}function I(t){this.rotate=t}function j(){this.noscale=!0}function C(t){this.scale=t}function W(t,e,i){this.color=t,this.stroke=e,this.layer=i||0}function $(t,e){this.context=t,this.manager=e,this.maxSize=100}function B(t,e){e.color&&(t.fillStyle=e.color,t.fill()),e.stroke&&(t.strokeStyle=e.stroke.color,t.lineWidth=e.stroke.width,t.stroke())}function L(t,e,i,n,s,r){t.moveTo(e,i+r),t.lineTo(e,i+s-r),t.arcTo(e,i+s,e+r,i+s,r),t.lineTo(e+n-r,i+s),t.arcTo(e+n,i+s,e+n,i+s-r,r),t.lineTo(e+n,i+r),t.arcTo(e+n,i,e+n-r,i,r),t.lineTo(e+r,i),t.arcTo(e,i,e,i+r,r)}function F(t){this.manager=t}x.prototype.x=0,x.prototype.y=0,x.prototype.z=0,x.prototype=Object.create(Array.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),x.prototype.add=function(t){let e=this.copy();for(var i=0;i<e.length;i++)Object.hasOwnProperty.call(e,i)&&Object.hasOwnProperty.call(t,i)&&(e[i]+=t[i]);return e},x.prototype.update=function(t){for(var e=0;e<this.length;e++)Object.hasOwnProperty.call(this,e)&&Object.hasOwnProperty.call(t,e)&&(this[e]=t[e])},x.prototype.negate=function(){let t=this.copy();for(var e=0;e<t.length;e++)Object.hasOwnProperty.call(t,e)&&(t[e]=-t[e]);return t},x.prototype.substract=function(t){return this.add(t.negate())},x.prototype.magnitude=function(){let t=0;for(var e=0;e<this.length;e++)Object.hasOwnProperty.call(this,e)&&(t+=this[e]*this[e]);return Math.sqrt(t)},x.prototype.normalise=function(t){let e=this.magnitude();return this.scale(1/e)},x.prototype.scale=function(t){let e=this.copy();for(var i=0;i<e.length;i++)Object.hasOwnProperty.call(e,i)&&(e[i]*=t);return e},x.prototype.copy=function(){return new this.constructor(this)},b.prototype.applyForce=function(t){for(var e=0;e<this.speeds.length;e++){if(isNaN(t[e]))throw new Error("Physics.prototype.applyForce got NnN");this.speeds[e]+=t[e]/this.mass}},b.prototype.applyAsc=function(t){for(var e=0;e<this.speeds.length;e++){if(isNaN(t[e]))throw new Error("Physics.prototype.applyAsc got NnN");this.speeds[e]+=t[e]}},b.prototype.compute=function(){var t,e=0;for(t=0;t<this.speeds.length;t++)e+=this.speeds[t]*this.speeds[t];var i=Math.min(1-this.drag,this.maxSpeed/e);for(t=0;t<this.speeds.length;t++)this.speeds[t]*=i},M.prototype.compute=function(){this.engines.forEach((t=>t.compute())),this.manager.getEnities(b).forEach((t=>{var e=this.manager.get(b,t)[0];e.compute();var i=this.manager.get(w,t)[0];i.positions=i.positions.add(e.speeds)}))},E.prototype.compute=function(){for(var t=this.manager.getEnities(b).filter((t=>this.manager.get(S,t)[0])).map((t=>{var e=this.manager.get(_,t)[0],i=this.manager.get(w,t)[0],n=this.manager.get(b,t)[0];return{e:t,radius:e.radius,circle:e,positions:i.positions,speeds:n.speeds,physics:n}})),e=0;e<t.length;e++){var i=t[e];if(this.manager.alive(i.e)){var n=k(i,t);for(var s in n){var r=n[s];this.manager.alive(r.e)&&(this.manager.destroy(r.e),this.merge(i,r))}}}},E.prototype.merge=function(t,e){var i=Math.pow(t.radius,3),n=Math.pow(e.radius,3),s=Math.cbrt(i+n);t.circle.radius=s;var r=t.physics.mass,a=e.physics.mass;t.physics.mass=r+a;for(var o=0;o<t.speeds.length;o++)t.speeds[o]=(t.speeds[o]*r+e.speeds[o]*a)/(r+a)},P.prototype.compute=function(){for(var t=this.manager.getEnities(b).map((t=>{var e=this.manager.get(b,t)[0],i=this.manager.get(w,t)[0];return{e:t,mass:e.mass,physics:e,positions:i.positions}})),e=0;e<t.length;e++){var i=t[e],n=O(i,t,this.interaction);i.physics.applyAsc(n)}},$.prototype.draw=function(t){const{context:e}=this;var i=e.canvas.clientWidth,n=e.canvas.clientHeight;const{x:s,y:r,scale:a,angle:o}=t,h=i/2,c=n/2,l=this.maxSize*a;o&&(e.save(),e.translate(h,c),e.rotate(o),e.translate(-h,-c)),this.manager.getEnities(W).map((t=>[t,this.manager.get(W,t)[0]])).sort((([,t],[,e])=>t.layer<e.layer?-1:t.layer>e.layer?1:0)).map((([t,o])=>{var u=this.manager.get(w,t)[0],p=(u.positions[0]-s)*a+h,d=(u.positions[1]-r)*a+c;if(p<-l||d<-l||p>i||d>n)return;let g=this.manager.get(j,t)[0],m=this.manager.get(C,t)[0],f=g?1:a*(m?.scale||1),y=this.manager.get(_,t);for(let t in y){let i=y[t];const n=i.radius*f>1?i.radius*f:1;e.beginPath(),e.arc(p,d,n,0,2*Math.PI,!1),B(e,o)}let v=this.manager.get(A,t),x=this.manager.get(N,t),b=this.manager.get(I,t)[0];for(let t in v){let i=v[t];const n=i.x*f>1?i.x*f:1,s=i.y*f>1?i.y*f:1;e.save(),b&&(e.translate(p+n/2,d+s/2),e.rotate(b.rotate),e.translate(-p-n/2,-d-s/2)),e.beginPath(),x[0]?L(e,p,d,n,s,x[0].radius):e.rect(p,d,n,s),B(e,o),e.restore()}let M=this.manager.get(T,t);for(let t in M){let i=M[t],n=v[0],s=n?.x||i.image.width,r=n?.x||i.image.height;const a=s*f>1?s*f+.5:1,o=r*f>1?r*f+.5:1;e.save(),b&&(e.translate(p+a/2,d+o/2),e.rotate(b.rotate),e.translate(-p-a/2,-d-o/2)),e.drawImage(i.image,p,d,a,o),e.restore()}let S=this.manager.get(D,t);for(let t in S){let i=S[t];const n=i.font*f>1?i.font*f:1;e.fillStyle=o.color,e.font=parseInt(n)+"px serif",e.save(),b&&(e.translate(p,d),e.rotate(b.rotate),e.translate(-p,-d)),e.fillText(i.text,p,d+parseInt(n)),e.restore()}})),o&&e.restore()},$.prototype.mesure=function(t){const{context:e}=this;return e.font=parseInt(t.font)+"px serif",e.measureText(t.text)};const q=[[245,202,117],[254,255,188],[200,141,110]];function H(t){let e=t.toString(16);return e.length-1?e:"0"+e}function J(t,e,i,n,s,r,a){return[(r-t)*i+n/2,(a-e)*i+s/2]}function R(t,e,i,n,s,r,a){return[(r-n/2)/i+t,(a-s/2)/i+e]}function z(t){this.canvas=t,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.img=this.context.createImageData(this.canvas.width,this.canvas.height)}F.prototype.compute=function(){this.manager.getEnities(W).map((t=>{var e=this.manager.get(W,t)[0],i=this.manager.get(b,t)[0].mass/(Math.pow(this.manager.get(_,t)[0].radius,3)*Math.PI)*q.length*3,n=Math.min(Math.round(i),q.length-1);e.color="#"+H(q[n][0])+H(q[n][1])+H(q[n][2])}))},z.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},z.prototype.getCanvas=function(){return this.canvas},z.prototype.worldToScreen=function(t,e){const{width:i,height:n}=this.canvas,{x:s,y:r,scale:a}=t;return J(s,r,a,i,n,e[0],e[1])},z.prototype.screenToWorld=function(t,e){const{width:i,height:n}=this.canvas,{x:s,y:r,scale:a}=t;return R(s,r,a,i,n,e[0],e[1])};const Z=z;function X(t){this.context=t,this.time=(new Date).getTime(),this.i=0,this.fps=0}X.prototype.draw=function(){this.i++;var t=(new Date).getTime(),e=t-this.time;this.time=t,this.context.font="14px Verdana",this.i%30||(this.fps=Math.round(1e4/e)/10+" fps"),this.context.beginPath(),this.context.rect(10,13,60,14),this.context.fillStyle="gray",this.context.fill(),this.context.fillStyle="red",this.context.fillText(this.fps,10,24)};const Y=X;function U(t,e,i){return t*(1-i)+e*i}function V(t,e){this.context=t,this.showCords=e?.showCords,this.showAxis=e?.showAxis,this.axisCords=e?.axisCords,this.axisScale=e?.axisScale||100,this.devide=e?.devide||2}V.prototype.draw=function(t,e,i){const{context:n}=this;var s=n.canvas.clientWidth,r=n.canvas.clientHeight;const{x:a,y:o,scale:h}=i,c=s/2,l=r/2;for(var u=h||1;u>2;)u/=2;for(;u<1;)u*=2;const p=t*u,d=e*u;if((y=(c-a*h)%p)<0&&(y+=p),(v=(l-o*h)%d)<0&&(v+=d),this.showAxis){n.beginPath();let[t,e]=J(a,o,h,s,r,0,0);n.lineWidth=2,n.moveTo(t,0),n.lineTo(t,r),n.moveTo(0,e),n.lineTo(s,e),n.strokeStyle="rgba(0, 0, 0, 1.0)",n.stroke()}n.beginPath();for(var g=y;g<=s;g+=p){if(n.moveTo(g,0),n.lineTo(g,r),!this.axisCords)continue;let t=R(a,o,h,s,r,g,0)[0];this.drawCod(t,0,i,n)}for(var m=v;m<=r;m+=d){if(n.moveTo(0,m),n.lineTo(s,m),!this.axisCords)continue;let t=R(a,o,h,s,r,0,m)[1];this.drawCod(0,t,i,n)}n.lineWidth=2,n.strokeStyle="rgba(128, 128, 128, 0.5)",n.stroke();for(var f=0;f<this.devide-1;f++){var y=(y+p/this.devide)%p,v=(v+d/this.devide)%d;for(n.beginPath(),g=y;g<=s;g+=p)n.moveTo(g,0),n.lineTo(g,r);for(m=v;m<=r;m+=d)n.moveTo(0,m),n.lineTo(s,m);n.lineWidth=1,n.strokeStyle="rgba(128, 128, 128, "+U(.25,.5,u-1)+")",n.stroke()}this.showCords&&(n.font="10px Arial",n.fillText(Math.round(i.x*this.axisScale)/this.axisScale+Number.EPSILON+","+Math.round(i.y*this.axisScale+Number.EPSILON)/this.axisScale+","+Math.round(i.scale*this.axisScale+Number.EPSILON)/this.axisScale,10,50))},V.prototype.drawCod=function(t,e,i,n){const{x:s,y:r,scale:a}=i;var o=n.canvas.clientWidth,h=n.canvas.clientHeight,c=(t-s)*a+o/2,l=(e-r)*a+h/2;let u=!1;function p(t){return+parseFloat(t).toFixed(2)}(c<5||c>o-19||l>h-28||l<14)&&(u=!0),c<5&&(c=5),l<14&&(l=14),c>o-19&&(c=o-19),l>h-28&&(l=h-28),n.font="14px Verdana",n.fillStyle="rgb(0, 0, 0, 1.0)";let d="",g=p(t/this.axisScale),m=p(-e/this.axisScale);g&&(d+=g),m&&(d+=m),m||g||u||(d+="0"),n.fillText(d,c+5,l+14)},V.prototype.line=function(t,e,i,n,s){this.context.lineWidth=1,this.context.moveTo(t,e),this.context.lineTo(t+i,e+n),this.context.strokeStyle=s,this.context.stroke()};const G=V;function K(t,e){this.context=t,this.update(),this.manager=e}K.prototype.update=function(){this.width=this.context.canvas.clientWidth,this.height=this.context.canvas.clientHeight,this.img=this.context.createImageData(this.width,this.height)},K.prototype.pull=function(){this.img=this.context.getImageData(0,0,this.width,this.height)},K.prototype.imgRect=function(t,e,i,n,s){null==s[3]&&s.push(Math.min(2*((t,e)=>{for(var i=0,n=0;n<t.length;n++)i+=(t[n]-e[n])*(t[n]-e[n]);return isNaN(i)||i<1?1:Math.sqrt(i)})(s,[0,0,0]),255));const r=Math.max(Math.min(i,this.width-t),0),a=Math.max(Math.min(n,this.height-e),0),o=Math.max(Math.round(t),0),h=Math.max(Math.round(e),0),c=this.img.data,l=4*o,u=4*r+l,p=4*this.width,d=h*p,g=a*p+d,m=s[3]/255;for(var f=d;f<g;f+=p)for(var y=l;y<u;y+=4){var v=f+y;c[v]=U(c[v],s[0],m),c[v+1]=U(c[v+1],s[1],m),c[v+2]=U(c[v+2],s[2],m),c[v+3]=Math.max(s[3],c[v+3])}};const Q=(t,e)=>{for(var i=0,n=0;n<t.length;n++)i+=Math.pow(t[n]-e.positions[n],2);return isNaN(i)||i<1?1:i};function tt(t,e){this.context=t,this.imgData=new K(t,e),this.manager=e}tt.prototype.update=function(){this.imgData.update()},tt.prototype.draw=function(t){const{x:e,y:i,scale:n}=t,{context:s}=this;var r=s.canvas.clientWidth,a=s.canvas.clientHeight;const o=r/2,h=a/2;var c=(e+o)%2,l=(i+h)%2,u=2/n;const p=this.manager.getEnities(b).map((t=>{var e=this.manager.get(b,t)[0],i=this.manager.get(w,t)[0];return{mass:e.mass,positions:i.positions}}));this.imgData.pull();for(var d=c;d<=r;d+=2)for(var g=(d-o)/n+e,m=(l-h)/n+i,f=l;f<=a;f+=2){for(var y=0,v=p.length,x=0;x<v;x++){var M=p[x];y+=3e3*M.mass/Q([g,m],M)}var _=Math.min(y/16,255),S=Math.max(Math.min(y,255)-_*_*.3,0);this.imgData.imgRect(d-1,f-1,2,2,[_,0,S]),m+=u}s.putImageData(this.imgData.img,0,0)},tt.prototype.imgRect=function(t,e,i,n,s){const r=Math.max(Math.min(i,this.context.canvas.clientWidth-t),0),a=Math.max(Math.min(n,this.context.canvas.clientHeight-e),0),o=Math.max(Math.round(t),0),h=Math.max(Math.round(e),0),c=this.img.data,l=4*o,u=4*r+l,p=4*this.context.canvas.clientWidth,d=h*p,g=a*p+d;for(var m=d;m<g;m+=p)for(var f=l;f<u;f+=4){var y=m+f;c[y]=s[0],c[y+1]=s[1],c[y+2]=s[2],c[y+3]=s[3]}};const et=tt,it=(t,e)=>{for(var i=0,n=0;n<t.length;n++)i+=(t[n]-e[n])*(t[n]-e[n]);return isNaN(i)||i<1?1:Math.sqrt(i)};function nt(t,e,i){this.colors=i,this.context=t,this.imgData=new K(t,e),this.manager=e}nt.prototype.update=function(){this.imgData.update()},nt.prototype.draw=function(t){const{x:e,y:i,scale:n}=t,{context:s}=this;var r=s.canvas.clientWidth,a=s.canvas.clientHeight;const o=r/2,h=a/2;var c=(e+o)%2,l=(i+h)%2,u=2/n;const p=this.manager.getEnities(b).map((t=>{var e=this.manager.get(b,t)[0],i=this.manager.get(w,t)[0];return{mass:e.mass,positions:i.positions}}));this.imgData.pull();for(var d=new Array(this.colors.length).fill(0),g=c;g<=r;g+=2)for(var m=(g-o)/n+e,f=(l-h)/n+i,y=l;y<=a;y+=2){for(var v=0,x=p.length,M=0;M<x;M++){var _=p[M];v+=_.mass/it([m,f],_.positions)}var S=Math.max(this.colors.length-v/64,0),E=S%1,k=Math.min(this.colors.length-1,Math.floor(S)),P=Math.min(this.colors.length-1,Math.ceil(S)),O=this.colors[P];let t=this.colors[k];d[k]++,O=O.map(((e,i)=>U(t[i],e,E))),this.imgData.imgRect(g-1,y-1,2,2,[O[0],O[1],O[2]]),f+=u}s.putImageData(this.imgData.img,0,0)};const st=nt;function rt(t,e){this.context=t,this.imgData=new K(t,e),this.update(),this.manager=e}rt.prototype.update=function(){this.width=this.context.canvas.clientWidth,this.height=this.context.canvas.clientHeight,this.step=4,this.widthSteps=this.width/this.step,this.heightSteps=this.height/this.step,this.number=this.widthSteps*this.heightSteps,this.cells={p:new Float32Array(this.number),v:new Float32Array(this.number),h:new Float32Array(this.number),o:new Uint8Array(this.number)},this.cells.p.fill(1),this.cells.v.fill(0),this.cells.h.fill(0),this.cells.o.fill(0),this.imgData.update()},rt.prototype.draw=function(t){const{x:e,y:i,scale:n}=t,{context:s}=this;var r=s.canvas.clientWidth,a=s.canvas.clientHeight;const o=r/2,h=a/2,c=this.step,l=this.step,u=c/2,p=l/2;var d=(e+o)%c,g=(i+h)%l,m=l/n;this.imgData.pull();const f=this.manager.getEnities(b).map((t=>{var e=this.manager.get(w,t)[0],i=this.manager.get(_,t)[0];return{speeds:this.manager.get(b,t)[0].speeds,radius:i&&i.radius,positions:e.positions}})).filter((({radius:t})=>!!t));for(var y=d;y<=r;y+=c)for(var v=(y-o)/n+e,x=(g-h)/n+i,M=Math.max(Math.round(v-u),0),S=g;S<=a;S+=l){for(var E=M+Math.max(Math.round(x-p),0)*this.widthSteps,k=0,P=f.length,O=0;O<P;O++){var A=f[O];A.radius>(N=A.positions[0],I=A.positions[1],function(t,e){return Math.sqrt(t*t,e*e)}(N-v,I-x))&&(this.cells.o[E]=1)}this.cells[E]&&(k+=128);var D=Math.min(k,255),T=Math.max(Math.min(k,255)-D*D*.3,0);this.imgData.imgRect(y-u,S-p,c,l,[255-T,0,255-D]),x+=m}var N,I;s.putImageData(this.imgData.img,0,0)};const at=rt;function ot(t,e){this.connects=t,this.distance=e}function ht(t){this.manager=t}ht.prototype.compute=function(){this.manager.getEnities(ot).map((t=>{var e=this.manager.get(ot,t).map((t=>({transform:this.manager.get(w,t.connects)[0],distance:t.distance}))),i=this.manager.get(w,t)[0],n=this.manager.get(b,t)[0],s=function(t,e){var i=[0,0];return t.forEach((({transform:t,distance:n})=>{var s=t.positions[0]-e.positions[0],r=t.positions[1]-e.positions[1],a=Math.atan2(r,s),o=Math.sqrt(s*s+r*r)/n,h=Math.atan(5*(o-1))+Math.pow(o-1,3),c=Math.cos(a)*h,l=Math.sin(a)*h;i[0]+=c,i[1]+=l})),i}(e,i);n.applyForce(s)}))};const ct=document.getElementById("phy_canvas"),lt=document.getElementById("tolook_value"),ut=document.getElementById("draw_mass"),pt=document.getElementById("draw_mass_rust"),dt=document.getElementById("draw_galaxy"),gt=document.getElementById("draw_gass"),mt=document.getElementById("draw_grid"),ft=document.getElementById("draw_fps"),yt=document.getElementById("full_speed"),vt=document.getElementById("draw_planets"),xt=document.getElementById("max_planets");var wt=new Z(ct);ct.width=640,ct.height=480;var bt={x:0,y:0,scale:.2};window.addEventListener("mousewheel",(function(t){bt.scale*=t.wheelDelta>0?1.1:.88}));const Mt=new Y(wt.context),_t=new G(wt.context);var St=new l;const Et=new $(wt.context,St),kt=new et(wt.context,St),Pt=new class{constructor(t,e){this.manager=e,this.context=t,this.positionArray=new Float32Array([0,0,1]),this.planetsArray=new Float32Array([]),this.imgData=new K(t,e),this.update()}update(){this.imgData.update(),this.width=this.context.canvas.clientWidth,this.height=this.context.canvas.clientHeight,this.gravity=null,h.e(720).then(h.bind(h,720)).then((({Gravity:t})=>{this.gravity=t.new(this.width,this.height)}))}drawAll(t){if(this.gravity){var e=this.gravity,i=this.manager.getEnities(b),n=3*i.length;this.planetsArray.length!==n&&(this.planetsArray=new Float32Array(3*i.length));var s=0;i.forEach((t=>{var e=this.manager.get(w,t)[0],i=this.manager.get(b,t)[0];this.planetsArray[s]=e.positions[0],this.planetsArray[s+1]=e.positions[1],this.planetsArray[s+2]=i.mass,s+=3})),this.positionArray[0]=t.x,this.positionArray[1]=t.y,this.positionArray[2]=t.scale,this.imgData.pull(),e.draw_planets(this.imgData.img.data,this.planetsArray,n,this.positionArray),this.context.putImageData(this.imgData.img,0,0)}}}(wt.context,St),Ot=new st(wt.context,St,[[255,255,255],[111,196,165],[163,123,173],[147,108,161],[44,78,138],[62,27,156],[100,24,29],[21,5,34],[10,12,29],[0,0,0]]),At=new at(wt.context,St),Dt=new P(St),Tt=new E(St),Nt=new F(St),It=new ht(St),jt=new M(St,[Dt,Tt,Nt,It]);new v(ct,100).sub("force",(({delta:t,deltaZoom:e})=>{bt={...bt,scale:bt.scale*e,x:bt.x-t.x/bt.scale,y:bt.y-t.y/bt.scale}}));var Ct=null,Wt=[];function $t(t,e,i){return Ct=St.create(),St.asign(new w(t),Ct),St.asign(new b(e,function(t){var e=.2+.05*Math.tanh(.2*(t-50))+.1*Math.tanh(.2*(20-t));return console.log(t,e),Math.pow(t,3)*Math.PI*e}(i),0),Ct),St.asign(new _(i),Ct),St.asign(new W("#aaffbb"),Ct),St.asign(new S,Ct),Ct}Wt.push($t([0,0],[0,0],55)),Wt.push($t([255,0],[0,5],3)),Wt.push($t([300,0],[0,5],4)),Wt.push($t([450,0],[0,4],7)),Wt.push($t([600,0],[0,4],4));let Bt=$t([1400,0],[0,2.5],35);Wt.push(Bt),Wt.push($t([1440,0],[0,6],2)),Wt.push($t([1450,0],[0,6],2)),Wt.push($t([2800,0],[0,2.5],5)),setInterval((()=>{let t=parseInt(xt.value)||100;if(Wt.length<t-10)for(let t=0;t<10;t++)1,void 0,void 0,void 0,void 0,void 0,void 0,e=2*Math.random()*Math.PI,i=200+2e3*Math.random(),n=Math.sin(e)*i,s=Math.cos(e)*i,r=Math.atan2(n,s)-Math.PI/2,a=$t([n,s],[10*Math.sin(r)+14*Math.random()-7,10*Math.cos(r)+14*Math.random()-7],1),Wt.push(a);var e,i,n,s,r,a;Wt.forEach(((e,i)=>i>t&&St.destroy(e)))}),50),function t(){var e=parseInt(lt.value)-1;if(!isNaN(e)&&e>=0){var i=Wt[e%Wt.length],n=St.get(w,i)[0];bt.x=n.positions[0],bt.y=n.positions[1]}wt.clear(),mt.checked&&_t.draw(100,100,bt),ut.checked&&kt.draw(bt),pt.checked&&Pt.drawAll(bt),gt.checked&&At.draw(bt),dt.checked&&Ot.draw(bt),vt.checked&&Et.draw(bt),ft.checked&&Mt.draw(),jt.compute(),Wt=Wt.filter((function(t,i){var n=St.alive(t);return!n&&!isNaN(e)&&e>=i&&(lt.value=e-1),n})),e>=Wt.length&&(lt.value=Wt.length-1),setTimeout(t,yt.checked?0:15)}()})();