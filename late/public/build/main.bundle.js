(()=>{var t={296:t=>{function e(t,e,i){var n,s,o,r,a;function h(){var l=Date.now()-r;l<e&&l>=0?n=setTimeout(h,e-l):(n=null,i||(a=t.apply(o,s),o=s=null))}null==e&&(e=100);var l=function(){o=this,s=arguments,r=Date.now();var l=i&&!n;return n||(n=setTimeout(h,e)),l&&(a=t.apply(o,s),o=s=null),a};return l.clear=function(){n&&(clearTimeout(n),n=null)},l.flush=function(){n&&(a=t.apply(o,s),o=s=null,clearTimeout(n),n=null)},l}e.debounce=e,t.exports=e}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function e(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function n(t,e,i,n){return n?{x:(e.x-t.x+(n.x-i.x))/2,y:(e.y-t.y+(n.y-i.y))/2}:{x:e.x-t.x,y:e.y-t.y}}function s(e,i,n,s){if(!s)return 1;if(!n)return 1;let o=t(e,n),r=t(i,s);return o<.01?1:r/o}function o(t,e,i,n){if(!n)return 0;let s=r(t,i);return r(e,n)-s}function r(t,e){let i=n(t,e);return Math.atan2(i.y,i.x)}function a(i,r){this.deadzone=r,this.clear();let a=null,h=null,l=null,c=null,u=null,f=0,p=!0,d=!1,g=!1;this.centerPosition={x:0,y:0},this.debug=!1,this.console_error=!1,this.throw_error=!1,this.last_error="",this.preventDefault=!0;const m=t=>{this.preventDefault&&t.preventDefault();const{top:e,left:i}=t.currentTarget.getBoundingClientRect();if(t.touches[1]&&t.touches[0]){let n={x:t.touches[0].clientX-i,y:t.touches[0].clientY-e},s={x:t.touches[1].clientX-i,y:t.touches[1].clientY-e};return this.centerPosition={x:(n.x+s.x)/2,y:(n.y+s.y)/2},x(n,s)}if(t.touches[0]){let n={x:t.touches[0].clientX-i,y:t.touches[0].clientY-e};return this.centerPosition={x:n.x,y:n.y},x(n)}return v(t)},y=t=>{if(this.preventDefault&&t.preventDefault(),0===t.buttons)return void v(t);const{top:e,left:i}=t.currentTarget.getBoundingClientRect();if(this.centerPosition={x:t.clientX-i,y:t.clientY-e},f){if("drag"==t.type&&0==t.clientX&&0==t.clientY)return;x({x:t.clientX-i,y:t.clientY-e})}},x=(i,r)=>{if(d=!0,null==a)return a={x:i.x,y:i.y},h=+new Date,c={x:i.x,y:i.y},this.triger("start",c),void(p=!0);if(r&&null==l)return g=!0,t(a,r)<t(a,i)&&(a={x:i.x,y:i.y},h=+new Date,c={x:i.x,y:i.y}),l={x:r.x,y:r.y},void(u={x:r.x,y:r.y});if(!r&&l)return g=!1,l=null,void(u=null);let m=n(c,i,u,r),y=s(c,i,u,r),x=o(c,i,u,r);c={x:i.x,y:i.y},u=r?{x:r.x,y:r.y}:null;let v=n(a,c,l,u),w=s(a,c,l,u),b=e(v),S=o(a,c,l,u),T=+new Date-h,P=this.debug&&`${a&&"Start: "+JSON.stringify(a)},\n\t\t${c&&"This: "+JSON.stringify(c)}, \n\t\t${l&&"Start secound: "+JSON.stringify(l)}, \n\t\t${u&&"Start this: "+JSON.stringify(u)},\n\t\t${m&&"Delta: "+JSON.stringify(m)},\n\t\t${"Zoom: "+w},\n\t\t${"DZoom: "+y}\n\t\t${"Angle: "+S}\n\t\t${"DAngle: "+x}\n\t\t${"isPrimary: "+(!g&&0==f||1==f)}\n\t\t${this.last_error}`,k={delta:m,direction:v,startPosition:a,position:c,distance:b,click:p,isClick:p,mouseDown:f,zoom:w,deltaZoom:y,touchSecound:g,angle:S,deltaAngle:x,startTime:h,deltaTime:T,isPrimary:!g&&0==f||1==f,debug:P,centerPosition:this.centerPosition};this.triger("force",k),b>this.deadzone&&(p=!1,Math.abs(v.x)>Math.abs(v.y)?v.x>0?this.triger("right",k):this.triger("left",k):v.y>0?this.triger("down",k):this.triger("up",k))},v=t=>{if(this.preventDefault&&t.preventDefault(),0==d)return;let i={x:0,y:0},r=n(a,c,l,u),m=s(a,c,l,u),y=o(a,c,l,u),x=e(r),v=+new Date-h,w=this.debug&&`${a&&"Start: "+JSON.stringify(a)},\n\t\t${c&&"This: "+JSON.stringify(c)}, \n\t\t${l&&"Start secound: "+JSON.stringify(l)}, \n\t\t${u&&"Start this: "+JSON.stringify(u)},\n\t\t${i&&"Delta: "+JSON.stringify(i)},\n\t\t${"Zoom: "+m},\n\t\tDZoom: 0\n\t\t${"Angle: "+y}\n\t\tDAngle: 0\n\t\t${"isPrimary: "+(!g&&0==f||1==f)}\n\t\t${this.last_error}`;const b={x:a.x,y:a.y,delta:i,direction:r,startPosition:a,position:c,distance:x,click:p,isClick:p,mouseDown:f,zoom:m,deltaZoom:0,touchSecound:g,angle:y,deltaAngle:0,startTime:h,deltaTime:v,isPrimary:!g&&0==f||1==f,debug:w,centerPosition:this.centerPosition};d=!1,g=!1;let S=a;p&&(t.button&&(1===t.button&&this.triger("bmiddle",b),2===t.button&&this.triger("bright",b)),S&&this.triger("click",b)),this.triger("stop",b),a=null,h=null,c=null,l=null,u=null,f=0};i.addEventListener("touchmove",m,!1),i.addEventListener("touchend",v,!1),i.addEventListener("touchstart",m,!1),i.addEventListener("mouseleave",v,!1),i.addEventListener("mousemove",y),i.addEventListener("drag",y),i.addEventListener("mouseup",v),i.addEventListener("mousedown",(t=>{f=1+t.button,y(t)}))}function h(t,e,i,n,s,o,r){return[(o-t)*i+n/2,(r-e)*i+s/2]}function l(t,e,i,n,s,o,r){return[(o-n/2)/i+t,(r-s/2)/i+e]}function c(t){this.canvas=t,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.img=this.context.createImageData(this.canvas.width,this.canvas.height)}a.prototype.sub=function(t,e){this.events[t]&&this.events[t].push(e)},a.prototype.onClick=function(t){this.events.click.push(t)},a.prototype.onForce=function(t){this.events.force.push(t)},a.prototype.onStart=function(t){this.events.start.push(t)},a.prototype.onStop=function(t){this.events.stop.push(t)},a.prototype.onUp=function(t){this.events.up.push(t)},a.prototype.onDown=function(t){this.events.down.push(t)},a.prototype.onLeft=function(t){this.events.left.push(t)},a.prototype.onRight=function(t){this.events.right.push(t)},a.prototype.unsub=function(t,e){this.events[t]&&(this.events[t]=this.events[t].filter((t=>t!==e)))},a.prototype.clearEvlent=function(t){this.events[t]&&(this.events[t]=[])},a.prototype.clear=function(){this.events={up:[],down:[],left:[],right:[],stop:[],start:[],click:[],force:[],bmiddle:[],bright:[]}},a.prototype.triger=function(t,e){this.events[t]&&this.events[t].forEach((t=>{try{t(e)}catch(t){if(this.console_error&&console.log(t),this.last_error="Error: "+t.name+" "+t.foo+" "+t.message+" "+t.stack,this.throw_error)throw t}}))},c.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},c.prototype.getCanvas=function(){return this.canvas},c.prototype.worldToScreen=function(t,e){const{width:i,height:n}=this.canvas,{x:s,y:o,scale:r}=t;return h(s,o,r,i,n,e[0],e[1])},c.prototype.screenToWorld=function(t,e){const{width:i,height:n}=this.canvas,{x:s,y:o,scale:r}=t;return l(s,o,r,i,n,e[0],e[1])};const u=c;function f(t,e){this.context=t,this.showCords=e?.showCords,this.showAxis=e?.showAxis,this.axisCords=e?.axisCords,this.axisScale=e?.axisScale||100,this.devide=e?.devide||2}f.prototype.draw=function(t,e,i){const{context:n}=this;var s=n.canvas.clientWidth,o=n.canvas.clientHeight;const{x:r,y:a,scale:c}=i,u=s/2,f=o/2;for(var p=c||1;p>2;)p/=2;for(;p<1;)p*=2;const d=t*p,g=e*p;var m;if((w=(u-r*c)%d)<0&&(w+=d),(b=(f-a*c)%g)<0&&(b+=g),this.showAxis){n.beginPath();let[t,e]=h(r,a,c,s,o,0,0);n.lineWidth=2,n.moveTo(t,0),n.lineTo(t,o),n.moveTo(0,e),n.lineTo(s,e),n.strokeStyle="rgba(0, 0, 0, 1.0)",n.stroke()}n.beginPath();for(var y=w;y<=s;y+=d){if(n.moveTo(y,0),n.lineTo(y,o),!this.axisCords)continue;let t=l(r,a,c,s,o,y,0)[0];this.drawCod(t,0,i,n)}for(var x=b;x<=o;x+=g){if(n.moveTo(0,x),n.lineTo(s,x),!this.axisCords)continue;let t=l(r,a,c,s,o,0,x)[1];this.drawCod(0,t,i,n)}n.lineWidth=2,n.strokeStyle="rgba(128, 128, 128, 0.5)",n.stroke();for(var v=0;v<this.devide-1;v++){var w=(w+d/this.devide)%d,b=(b+g/this.devide)%g;for(n.beginPath(),y=w;y<=s;y+=d)n.moveTo(y,0),n.lineTo(y,o);for(x=b;x<=o;x+=g)n.moveTo(0,x),n.lineTo(s,x);n.lineWidth=1,n.strokeStyle="rgba(128, 128, 128, "+(.25*(1-(m=p-1))+.5*m)+")",n.stroke()}this.showCords&&(n.font="10px Arial",n.fillText(Math.round(i.x*this.axisScale)/this.axisScale+Number.EPSILON+","+Math.round(i.y*this.axisScale+Number.EPSILON)/this.axisScale+","+Math.round(i.scale*this.axisScale+Number.EPSILON)/this.axisScale,10,50))},f.prototype.drawCod=function(t,e,i,n){const{x:s,y:o,scale:r}=i;var a=n.canvas.clientWidth,h=n.canvas.clientHeight,l=(t-s)*r+a/2,c=(e-o)*r+h/2;let u=!1;function f(t){return+parseFloat(t).toFixed(2)}(l<5||l>a-19||c>h-28||c<14)&&(u=!0),l<5&&(l=5),c<14&&(c=14),l>a-19&&(l=a-19),c>h-28&&(c=h-28),n.font="14px Verdana",n.fillStyle="rgb(0, 0, 0, 1.0)";let p="",d=f(t/this.axisScale),g=f(-e/this.axisScale);d&&(p+=d),g&&(p+=g),g||d||u||(p+="0"),n.fillText(p,l+5,c+14)},f.prototype.line=function(t,e,i,n,s){this.context.lineWidth=1,this.context.moveTo(t,e),this.context.lineTo(t+i,e+n),this.context.strokeStyle=s,this.context.stroke()};const p=f;function d(){}function g(){this._entities=new Set,this._components=new Map}function m(t){this.context=t,this.scale=100}g.prototype.create=function(){var t=this.make_entity();return this._entities.add(t),this._components.set(t,new Map),t},g.prototype.make_entity=function(){return new d},g.prototype.alive=function(t){return this._entities.has(t)},g.prototype.destroy=function(t){this._components.delete(t),this._entities.delete(t)},g.prototype.asign=function(t,e){if(!e)throw Error("Can't asign to "+e);if(!(e instanceof d))throw Error(e+" is not Entity");var i=this._components.get(e);if(!i)throw Error(e+" not Entity form this set");var n=i.get(t.constructor.name);if(n){if(n&&i.get(t.constructor.name).has(t))throw Error("Component is allready asiged");n.add(t)}else this._components.get(e).set(t.constructor.name,new Set([t]))},g.prototype.get=function(t,e){var i=this._components.get(e);if(!i)return[];var n=i.get(t.name);return n?Array.from(n):[]},g.prototype.remove=function(t,e){var i=this._components.get(e);if(i){var n=i.get(t.constructor.name);n&&n.delete(t)}},g.prototype.getEnities=function(t){return[...this._entities.values()].filter((e=>e&&this.get(t,e).length))},m.prototype.draw=function(t,e,i){const{context:n}=this;var s=n.canvas.clientWidth,o=n.canvas.clientHeight;const{x:r,y:a,scale:h}=t,l=s/2,c=o/2;var u=(-r*h+l)%2;n.beginPath(),n.moveTo(f,0);for(var f=u;f<=s;f+=2){var p=(-e(((f-l)/h+r)/this.scale)*this.scale-a)*h+c;isNaN(p)||(p>o+5&&(p=o+5),p<-5&&(p=-5),n.lineTo(f,p))}n.lineWidth=2,n.strokeStyle=i||"rgba(0, 0, 0, 1)",n.stroke()};const y=m;function x(){const t=[...arguments];if(Array.call(this),1==t.length){var e=Object.values(t[0]);this.push(...e)}else this.push(...Object.values(t));Object.defineProperty(this,"x",{get(){return this[0]},set(t){this[0]=t}}),Object.defineProperty(this,"y",{get(){return this[1]},set(t){this[1]=t}}),Object.defineProperty(this,"z",{get(){return this[2]},set(t){this[2]=t}}),Object.defineProperty(this,"length",{enumerable:!1,writable:!0})}function v(t){this.positions=new x(t)}function w(t,e){this.x=t,this.y=e}function b(t){this.radius=t}function S(t,e){this.font=t,this.text=e}function T(t){this.image=t}function P(t){this.radius=t}function k(t){this.rotate=t}function O(){this.noscale=!0}function E(t){this.scale=t}function N(t,e,i){this.image=t,this.x=e,this.y=i}function _(){}function C(t){this.to=t}function j(t,e,i){this.color=t,this.stroke=e,this.layer=i||0}function W(t,e){this.context=t,this.manager=e,this.maxSize=100}function D(t,e){e.color&&(t.fillStyle=e.color,t.fill()),e.stroke&&(t.strokeStyle=e.stroke.color,t.lineWidth=e.stroke.width,t.stroke())}function M(t,e,i,n,s,o){t.moveTo(e,i+o),t.lineTo(e,i+s-o),t.arcTo(e,i+s,e+o,i+s,o),t.lineTo(e+n-o,i+s),t.arcTo(e+n,i+s,e+n,i+s-o,o),t.lineTo(e+n,i+o),t.arcTo(e+n,i,e+n-o,i,o),t.lineTo(e+o,i),t.arcTo(e,i,e,i+o,o)}x.from=function(t){return new x(t)},x.prototype.x=0,x.prototype.y=0,x.prototype.z=0,x.prototype=Object.create(Array.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),x.prototype.add=function(t){let e=this.copy();for(var i in e)Object.hasOwnProperty.call(t,i)&&(e[i]+=t[i]);return e},Object.defineProperty(x.prototype,"add",{enumerable:!1}),x.prototype.update=function(t){let e=Object.entries(t);for(var i=0;i<e.length;i++){let t=e[i];Object.hasOwnProperty.call(this,t[0])&&(this[i]=t[1])}},Object.defineProperty(x.prototype,"update",{enumerable:!1}),x.prototype.negate=function(){let t=this.copy();for(var e in this)t[e]=-t[e];return t},Object.defineProperty(x.prototype,"negate",{enumerable:!1}),x.prototype.substract=function(t){return this.add(t.negate())},Object.defineProperty(x.prototype,"substract",{enumerable:!1}),x.prototype.magnitude=function(){let t=0;for(var e of this)t+=e*e;return Math.sqrt(t)},Object.defineProperty(x.prototype,"magnitude",{enumerable:!1}),x.prototype.normalise=function(t){let e=this.magnitude();return e?this.scale(1/e):this.scale(0)},Object.defineProperty(x.prototype,"normalise",{enumerable:!1}),x.prototype.scale=function(t){let e=this.copy();for(var i in this)e[i]*=t;return e},Object.defineProperty(x.prototype,"scale",{enumerable:!1}),x.prototype.copy=function(){return new x(this)},Object.defineProperty(x.prototype,"copy",{enumerable:!1}),_.render=function(t,e,i,n,s){for(let o=0;o<i;o+=s)for(let r=0;r<e;r+=n){let a=Math.min(n,e-r),h=Math.min(s,i-o);this.context.drawImage(t,r,o,a,h)}},W.prototype.draw=function(t){const{context:e}=this;var i=e.canvas.clientWidth,n=e.canvas.clientHeight;const{x:s,y:o,scale:r,angle:a}=t,h=i/2,l=n/2,c=this.maxSize*r;a&&(e.save(),e.translate(h,l),e.rotate(a),e.translate(-h,-l));let u=this.manager.getEnities(j).map((t=>[t,this.manager.get(j,t)[0]])),f=new Map(u.map((([t])=>{var e=this.manager.get(v,t).reduce(((t,e)=>(t[0]+=e.positions[0],t[1]+=e.positions[1],t)),[0,0]);return[t,{x:(e[0]-s)*r+h,y:(e[1]-o)*r+l}]})));u.sort((([,t],[,e])=>t.layer<e.layer?-1:t.layer>e.layer?1:0)).map((([t,s])=>{let{x:o,y:a}=f.get(t);if(o<-c||a<-c||o>i||a>n)return;let h=this.manager.get(O,t)[0],l=this.manager.get(E,t)[0],u=h?1:r*(l?.scale||1),p=this.manager.get(b,t);for(let t in p){let i=p[t];const n=i.radius*u>1?i.radius*u:1;e.beginPath(),e.arc(o,a,n,0,2*Math.PI,!1),D(e,s)}let d=this.manager.get(w,t),g=this.manager.get(C,t),m=this.manager.get(P,t),y=this.manager.get(k,t)[0];for(let t in g){let i=g[t];if(!f.has(i.to))continue;let n=f.get(i.to);e.beginPath(),e.moveTo(o,a),e.lineTo(n.x,n.y),e.closePath(),D(e,s)}for(let t in d){let i=d[t];const n=i.x*u>1?i.x*u:1,r=i.y*u>1?i.y*u:1;e.save(),y&&(e.translate(o+n/2,a+r/2),e.rotate(y.rotate),e.translate(-o-n/2,-a-r/2)),e.beginPath(),m[0]?M(e,o,a,n,r,m[0].radius):e.rect(o,a,n,r),D(e,s),e.restore()}let x=this.manager.get(T,t);for(let t in x){let i=x[t],n=d[0],s=n?.x||i.image.width,r=n?.y||i.image.height;const h=s*u>1?s*u+.5:1,l=r*u>1?r*u+.5:1;e.save(),y&&(e.translate(o+h/2,a+l/2),e.rotate(y.rotate),e.translate(-o-h/2,-a-l/2)),e.drawImage(i.image,o,a,h,l),e.restore()}this.manager.get(N,t).forEach((t=>{let i=d[0],n=i?.x||t.image.width,s=i?.y||t.image.height;const r=n*u>1?n*u+.5:1,h=r/n,l=s*u>1?s*u+.5:1;e.save(),y&&(e.translate(o+r/2,a+l/2),e.rotate(y.rotate),e.translate(-o-r/2,-a-l/2)),e.translate(o,a),_.render.call(this,t.image,r,l,t.x*h,t.y*h,e),e.restore()}));let v=this.manager.get(S,t);for(let t in v){let i=v[t];const n=i.font*u>1?i.font*u:1;e.fillStyle=s.color,e.font=parseInt(n)+"px serif",e.save(),y&&(e.translate(o,a),e.rotate(y.rotate),e.translate(-o,-a)),e.fillText(i.text,o,a+parseInt(n)),e.restore()}})),a&&e.restore()},W.prototype.mesure=function(t){const{context:e}=this;return e.font=parseInt(t.font)+"px serif",e.measureText(t.text)};class L{constructor(t,e){this.func=t=>t,this.trailProb=.05,this.taskNumber=6,this.work=function(t){this.points.draw(t)},this.draw=t,this.input=e;let i=new g;this.manager=i,this.points=new W(t.context,this.manager),this.entities=[],this.fPloter=new y(t.context),this.init()}trail(t){return Math.tanh(6*t-4)+Math.tanh(3*-t+4.3)*(1-this.trailProb)+Math.tanh(4.3-t)*this.trailProb}addPoint(t,e,i="#ff0000"){let n=this.manager.create();this.entities.push(n);let s=new v([100*t,100*e]);this.manager.asign(s,n),this.manager.asign(new b(4),n),this.manager.asign(new j(i,{color:"gray",width:1}),n)}init(){this.entities.forEach((t=>this.manager.destroy(t))),this.entities=[];let t={};for(let e=0;e<200;e++)t[e]=this.trail(e/10);let e=this.combineTwoTasks(t,t),i=this.combineTwoTasks(t,e),n=t;for(let e=0;e<this.taskNumber;e++)n=this.combineTwoTasks(t,n);for(let s=0;s<200;s++)this.addPoint(s/10,-t[s]||0),this.addPoint(s/10,-e[s]||0,"#00ff00"),this.addPoint(s/10,-i[s]||0,"#0000ff"),this.addPoint(s/10,-n[s]||0,"#00ffff")}combineTwoTasks(t,e){let i={};for(let n=0;n<100;n++)for(let s=0;s<200;s++){let o=n+s,r=t[n]*e[s]/14;i[o]=i[o]?i[o]+r:r}return i}setTask(t){let e=parseFloat(t);isFinite(e)&&(this.taskNumber=e,this.init())}setTail(t){let e=parseFloat(t);isFinite(e)&&(this.trailProb=e/100,this.init())}}function $(t,e){x.call(this),this.push(0,0,1,0),this.screen=t,Object.assign(this,e||{}),Object.defineProperty(this,"scale",{get(){return this[2]},set(t){this[2]=t}}),Object.defineProperty(this,"angle",{get(){return this[3]},set(t){this[3]=t}})}function z(){this.isSelected=!1,this.index=0}$.prototype=Object.create(x.prototype),$.prototype.zoom=function(t,e,i){if(this.scale*=t,!isNaN(this.minScale)&&this.scale<this.minScale)this.scale=this.minScale;else if(!isNaN(this.maxScale)&&this.scale>this.maxScale)this.scale=this.maxScale;else if(void 0!==e&&void 0!==i){let n=t-1,s=(this.screen.width/2-e)*n,o=(this.screen.height/2-i)*n;this.move(s,o)}},$.prototype.rotate=function(t){this.angle+=t,this.saveToLocalStorage()},$.prototype.move=function(t,e){let i=t/this.scale,n=e/this.scale;this.x-=i,this.y-=n,!isNaN(this.minX)&&this.x<this.minX&&(this.x=this.minX),!isNaN(this.maxX)&&this.x>this.maxX&&(this.x=this.maxX),!isNaN(this.minY)&&this.y<this.minY&&(this.y=this.minY),!isNaN(this.maxY)&&this.y>this.maxY&&(this.y=this.maxY),this.saveToLocalStorage()},$.prototype.loadFromLocalStorage=function(t){this.localStorageKey=t;let e=localStorage.getItem(this.localStorageKey);if(e){let t=JSON.parse(e);this[0]=t[0]||0,this[1]=t[1]||0,this[2]=t[2]||1,this[3]=t[3]||0}},$.prototype.saveToLocalStorage=function(){this.localStorageKey&&localStorage.setItem(this.localStorageKey,JSON.stringify(this))};const I=(t,e,i,n,s,o,r)=>{let a=t.create();return t.asign(new v([e,i]),a),t.asign(new w(n,s),a),t.asign(new j(o,r),a),t.asign(new P(5),a),a};function X(t,e){let i=t.split(/\r?\n/),n=[];for(let t of i){if(t.length<e){n.push(t);continue}let i=t.split(" "),s="";for(let t of i)t.length>e&&(t=t.slice(0,e-4),t+="..."),s.length+t.length>e&&(n.push(s.slice(1)),s=""),s+=" "+t;s.length&&n.push(s.slice(1))}return n}function Y(){}function A(t,...e){e.forEach((e=>t.asign(new Y,e)))}function J(t){this.checked=t}class H{}class F{constructor(t){this.ploter=t,this.manager=new g,this.render=new W(this.ploter.context,this.manager),this.input_position=new $(t.canvas),this.stabilex=30,this.stabiley=30,this.inputs={},this.baloonText=""}getWith(){return this.ploter.canvas.width}getHeight(){return this.ploter.canvas.height}setResolution(){this.input_position.x=this.getWith()/2,this.input_position.y=this.getHeight()/2}touchClick({x:t,y:e}){var i=this.ploter.screenToWorld(this.input_position,[t,e]);const n=this.manager.getEnities(z).map((t=>{var e=this.manager.get(v,t)[0],i=this.manager.get(w,t)[0],n=this.manager.get(z,t)[0];return n.index=0,{transform:e,box:i,selectable:n,id:t}})).filter((({transform:t,box:e})=>function(t,e,i){return!(t[0]>i[0]||t[1]>i[1]||t[0]+e[0]<i[0]||t[1]+e[1]<i[1])}(t.positions,[e.x,e.y],i)))[0];if(n){let t=this.manager.get(J,n.id)[0];t&&this.setState(n.id,!t.checked)}return n}addTogle(t){let e=new S(20,t),i=this.render.mesure(e).width,n=this.manager.create();this.manager.asign(new v([this.stabilex,this.stabiley]),n),this.manager.asign(new w(i+10,30),n),this.manager.asign(new j("#555555"),n),this.manager.asign(new z,n),this.manager.asign(new J(!1),n),this.all.push(n);let s=this.manager.create();return this.manager.asign(new v([this.stabilex+5,this.stabiley]),s),this.manager.asign(e,s),this.manager.asign(new j("#cccccc"),s),this.all.push(s),this.stabilex+=i+15,this.inputs[t]=n,n}getCheckedByText(t){if(!this.inputs[t])return!1;let e=this.manager.get(J,this.inputs[t])[0];return!!e&&e.checked}setState(t,e){let i=this.manager.get(j,t)[0];i&&(i.color=e?"#888888":"#555555");let n=this.manager.get(J,t)[0];n&&(n.checked=e)}setBaloonText(t){if(this.baloonText==t)return;if(this.baloonText=t,this.manager.getEnities(H).forEach((t=>{this.manager.destroy(t)})),!this.baloonText)return;let e=function(t,e,i,n,s){let o=[],r=s?.textSize||20,a=s?.lineHeight||r+10,h=s?.background||"#ffffffaa",l=s?.borderColor||"#ffffff",c=s?.borderWidth||1,u=s?.anchor||[0,0],f=s?.paddingX||s?.padding||10,p=s?.paddingY||s?.padding||10,d=s?.minWidth||0,g=s?.minHeight||0,m=s?.maxWidth||0,y=0,x=n.split(/\r?\n/).map((t=>{let i=new S(r,t),n=e.mesure(i).width,s=n+2*f;if(!m||s<m)return y=Math.max(n,y),[i];for(let i=t.length-1;0<i;i--){let n=X(t,i).map((t=>new S(r,t))),o=n.map((t=>e.mesure(t).width));if(s=Math.max(...o.map((t=>t+2*f))),s<m)return y=Math.max(y,...o),n}return[i]}));x=x.flat();let w=y+2*f;w=Math.max(d,w);let b=x.length*a+2*p;b=Math.max(g,b);let T=i[0]-w*u[0],P=i[1]-b*u[1],k=((t,e,i,n,s,o,r)=>{let a=r.width-1,h=I(t,e-a,i-a,n+2*a,s+2*a,null,{...r,width:a+2});return[I(t,e,i,n,s,o),h]})(t,T,P,w,b,h,{color:l,width:c});return o.push(...k),A(t,...k),x.map(((e,i)=>{let n=t.create();t.asign(new v([T+f,P+p+i*a]),n),t.asign(e,n),t.asign(new j("#000000",null,2),n),o.push(n),A(t,n)})),o}(this.manager,this.render,[this.getWith()-126,this.getHeight()-30],this.baloonText,{textSize:20,maxWidth:this.getWith()-136,minWidth:this.getWith()-136,anchor:[1,1],borderColor:"#aaaaaa",background:"#aaaaaaaa"});e.map((t=>this.manager.asign(new H,t)))}work(){this.render.draw(this.input_position)}}var B=i(296),R=i.n(B);const Z=document.getElementById("phy_canvas");let{work:q,adjustWindowSize:K}=function(t,e){var i=new u(t),n=new F(i),s=new $(t,{minX:-2e3,minY:-2e3,maxX:2e3,maxY:2e3,minScale:.15,maxScale:3}),o=new L(i,n);let r=document.getElementById("slider1"),h=R()(o.setTail.bind(o),200);r.addEventListener("input",(t=>{h(t.target.value)}));let l=document.getElementById("slider2"),c=R()(o.setTask.bind(o),200);l.addEventListener("input",(t=>{c(t.target.value)}));var f=new a(t,20);f.throw_error=!0,window.addEventListener("mousewheel",(function(t){s.zoom(t.wheelDelta>0?1.1:.88,f.centerPosition.x,f.centerPosition.y)})),document.addEventListener("contextmenu",(function(t){t.preventDefault()}));const d=new p(i.context,{axisCords:!0,devide:4,showAxis:!1});let g=!1,m=!1;return f.onForce((t=>{var{delta:e,deltaZoom:i,isPrimary:n,centerPosition:o,position:r,isClick:a}=t;1!=i&&s.zoom(i,o.x,o.y),s.move(e.x,e.y)})),f.onStop((t=>{g=!1,m=!1})),f.onClick((t=>{n.touchClick(t)})),{work:function(){i.clear(),d.draw(100,100,s),o.work(s),n.work()},adjustWindowSize:function(){n.setResolution()}}}(Z);window.addEventListener("resize",(()=>{Z.width=window.innerWidth-10,Z.height=window.innerHeight-10,K()})),Z.width=window.innerWidth-10,Z.height=window.innerHeight-10,K();let U=()=>{q(),setTimeout(U,0)};U()})()})();