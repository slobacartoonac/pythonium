(()=>{var t={296:t=>{function e(t,e,n){var i,s,o,r,a;function l(){var h=Date.now()-r;h<e&&h>=0?i=setTimeout(l,e-h):(i=null,n||(a=t.apply(o,s),o=s=null))}null==e&&(e=100);var h=function(){o=this,s=arguments,r=Date.now();var h=n&&!i;return i||(i=setTimeout(l,e)),h&&(a=t.apply(o,s),o=s=null),a};return h.clear=function(){i&&(clearTimeout(i),i=null)},h.flush=function(){i&&(a=t.apply(o,s),o=s=null,clearTimeout(i),i=null)},h}e.debounce=e,t.exports=e}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function e(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function i(t,e,n,i){return i?{x:(e.x-t.x+(i.x-n.x))/2,y:(e.y-t.y+(i.y-n.y))/2}:{x:e.x-t.x,y:e.y-t.y}}function s(e,n,i,s){if(!s)return 1;if(!i)return 1;let o=t(e,i),r=t(n,s);return o<.01?1:r/o}function o(t,e,n,i){if(!i)return 0;let s=r(t,n);return r(e,i)-s}function r(t,e){let n=i(t,e);return Math.atan2(n.y,n.x)}function a(n,r){this.deadzone=r,this.clear();let a=null,l=null,h=null,c=null,u=null,d=0,p=!0,f=!1,g=!1;this.centerPosition={x:0,y:0},this.debug=!1,this.console_error=!1,this.throw_error=!1,this.last_error="",this.preventDefault=!0;const m=t=>{this.preventDefault&&t.preventDefault();const{top:e,left:n}=t.currentTarget.getBoundingClientRect();if(t.touches[1]&&t.touches[0]){let i={x:t.touches[0].clientX-n,y:t.touches[0].clientY-e},s={x:t.touches[1].clientX-n,y:t.touches[1].clientY-e};return this.centerPosition={x:(i.x+s.x)/2,y:(i.y+s.y)/2},x(i,s)}if(t.touches[0]){let i={x:t.touches[0].clientX-n,y:t.touches[0].clientY-e};return this.centerPosition={x:i.x,y:i.y},x(i)}return v(t)},y=t=>{if(this.preventDefault&&t.preventDefault(),0===t.buttons)return void v(t);const{top:e,left:n}=t.currentTarget.getBoundingClientRect();if(this.centerPosition={x:t.clientX-n,y:t.clientY-e},d){if("drag"==t.type&&0==t.clientX&&0==t.clientY)return;x({x:t.clientX-n,y:t.clientY-e})}},x=(n,r)=>{if(f=!0,null==a)return a={x:n.x,y:n.y},l=+new Date,c={x:n.x,y:n.y},this.triger("start",c),void(p=!0);if(r&&null==h)return g=!0,t(a,r)<t(a,n)&&(a={x:n.x,y:n.y},l=+new Date,c={x:n.x,y:n.y}),h={x:r.x,y:r.y},void(u={x:r.x,y:r.y});if(!r&&h)return g=!1,h=null,void(u=null);let m=i(c,n,u,r),y=s(c,n,u,r),x=o(c,n,u,r);c={x:n.x,y:n.y},u=r?{x:r.x,y:r.y}:null;let v=i(a,c,h,u),w=s(a,c,h,u),b=e(v),T=o(a,c,h,u),k=+new Date-l,S=this.debug&&`${a&&"Start: "+JSON.stringify(a)},\n\t\t${c&&"This: "+JSON.stringify(c)}, \n\t\t${h&&"Start secound: "+JSON.stringify(h)}, \n\t\t${u&&"Start this: "+JSON.stringify(u)},\n\t\t${m&&"Delta: "+JSON.stringify(m)},\n\t\t${"Zoom: "+w},\n\t\t${"DZoom: "+y}\n\t\t${"Angle: "+T}\n\t\t${"DAngle: "+x}\n\t\t${"isPrimary: "+(!g&&0==d||1==d)}\n\t\t${this.last_error}`,C={delta:m,direction:v,startPosition:a,position:c,distance:b,click:p,isClick:p,mouseDown:d,zoom:w,deltaZoom:y,touchSecound:g,angle:T,deltaAngle:x,startTime:l,deltaTime:k,isPrimary:!g&&0==d||1==d,debug:S,centerPosition:this.centerPosition};this.triger("force",C),b>this.deadzone&&(p=!1,Math.abs(v.x)>Math.abs(v.y)?v.x>0?this.triger("right",C):this.triger("left",C):v.y>0?this.triger("down",C):this.triger("up",C))},v=t=>{if(this.preventDefault&&t.preventDefault(),0==f)return;let n={x:0,y:0},r=i(a,c,h,u),m=s(a,c,h,u),y=o(a,c,h,u),x=e(r),v=+new Date-l,w=this.debug&&`${a&&"Start: "+JSON.stringify(a)},\n\t\t${c&&"This: "+JSON.stringify(c)}, \n\t\t${h&&"Start secound: "+JSON.stringify(h)}, \n\t\t${u&&"Start this: "+JSON.stringify(u)},\n\t\t${n&&"Delta: "+JSON.stringify(n)},\n\t\t${"Zoom: "+m},\n\t\tDZoom: 0\n\t\t${"Angle: "+y}\n\t\tDAngle: 0\n\t\t${"isPrimary: "+(!g&&0==d||1==d)}\n\t\t${this.last_error}`;const b={x:a.x,y:a.y,delta:n,direction:r,startPosition:a,position:c,distance:x,click:p,isClick:p,mouseDown:d,zoom:m,deltaZoom:0,touchSecound:g,angle:y,deltaAngle:0,startTime:l,deltaTime:v,isPrimary:!g&&0==d||1==d,debug:w,centerPosition:this.centerPosition};f=!1,g=!1;let T=a;p&&(t.button&&(1===t.button&&this.triger("bmiddle",b),2===t.button&&this.triger("bright",b)),T&&this.triger("click",b)),this.triger("stop",b),a=null,l=null,c=null,h=null,u=null,d=0};n.addEventListener("touchmove",m,!1),n.addEventListener("touchend",v,!1),n.addEventListener("touchstart",m,!1),n.addEventListener("mouseleave",v,!1),n.addEventListener("mousemove",y),n.addEventListener("drag",y),n.addEventListener("mouseup",v),n.addEventListener("mousedown",(t=>{d=1+t.button,y(t)}))}function l(t,e,n,i,s,o,r){return[(o-t)*n+i/2,(r-e)*n+s/2]}function h(t,e,n,i,s,o,r){return[(o-i/2)/n+t,(r-s/2)/n+e]}function c(t){this.canvas=t,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.img=this.context.createImageData(this.canvas.width,this.canvas.height)}a.prototype.sub=function(t,e){this.events[t]&&this.events[t].push(e)},a.prototype.onClick=function(t){this.events.click.push(t)},a.prototype.onForce=function(t){this.events.force.push(t)},a.prototype.onStart=function(t){this.events.start.push(t)},a.prototype.onStop=function(t){this.events.stop.push(t)},a.prototype.onUp=function(t){this.events.up.push(t)},a.prototype.onDown=function(t){this.events.down.push(t)},a.prototype.onLeft=function(t){this.events.left.push(t)},a.prototype.onRight=function(t){this.events.right.push(t)},a.prototype.unsub=function(t,e){this.events[t]&&(this.events[t]=this.events[t].filter((t=>t!==e)))},a.prototype.clearEvlent=function(t){this.events[t]&&(this.events[t]=[])},a.prototype.clear=function(){this.events={up:[],down:[],left:[],right:[],stop:[],start:[],click:[],force:[],bmiddle:[],bright:[]}},a.prototype.triger=function(t,e){this.events[t]&&this.events[t].forEach((t=>{try{t(e)}catch(t){if(this.console_error&&console.log(t),this.last_error="Error: "+t.name+" "+t.foo+" "+t.message+" "+t.stack,this.throw_error)throw t}}))},c.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},c.prototype.getCanvas=function(){return this.canvas},c.prototype.worldToScreen=function(t,e){const{width:n,height:i}=this.canvas,{x:s,y:o,scale:r}=t;return l(s,o,r,n,i,e[0],e[1])},c.prototype.screenToWorld=function(t,e){const{width:n,height:i}=this.canvas,{x:s,y:o,scale:r}=t;return h(s,o,r,n,i,e[0],e[1])};const u=c;function d(t,e){this.context=t,this.showCords=e?.showCords,this.showAxis=e?.showAxis,this.axisCords=e?.axisCords,this.axisScale=e?.axisScale||100,this.devide=e?.devide||2}d.prototype.draw=function(t,e,n){const{context:i}=this;var s=i.canvas.clientWidth,o=i.canvas.clientHeight;const{x:r,y:a,scale:c}=n,u=s/2,d=o/2;for(var p=c||1;p>2;)p/=2;for(;p<1;)p*=2;const f=t*p,g=e*p;var m;if((w=(u-r*c)%f)<0&&(w+=f),(b=(d-a*c)%g)<0&&(b+=g),this.showAxis){i.beginPath();let[t,e]=l(r,a,c,s,o,0,0);i.lineWidth=2,i.moveTo(t,0),i.lineTo(t,o),i.moveTo(0,e),i.lineTo(s,e),i.strokeStyle="rgba(0, 0, 0, 1.0)",i.stroke()}i.beginPath();for(var y=w;y<=s;y+=f){if(i.moveTo(y,0),i.lineTo(y,o),!this.axisCords)continue;let t=h(r,a,c,s,o,y,0)[0];this.drawCod(t,0,n,i)}for(var x=b;x<=o;x+=g){if(i.moveTo(0,x),i.lineTo(s,x),!this.axisCords)continue;let t=h(r,a,c,s,o,0,x)[1];this.drawCod(0,t,n,i)}i.lineWidth=2,i.strokeStyle="rgba(128, 128, 128, 0.5)",i.stroke();for(var v=0;v<this.devide-1;v++){var w=(w+f/this.devide)%f,b=(b+g/this.devide)%g;for(i.beginPath(),y=w;y<=s;y+=f)i.moveTo(y,0),i.lineTo(y,o);for(x=b;x<=o;x+=g)i.moveTo(0,x),i.lineTo(s,x);i.lineWidth=1,i.strokeStyle="rgba(128, 128, 128, "+(.25*(1-(m=p-1))+.5*m)+")",i.stroke()}this.showCords&&(i.font="10px Arial",i.fillText(Math.round(n.x*this.axisScale)/this.axisScale+Number.EPSILON+","+Math.round(n.y*this.axisScale+Number.EPSILON)/this.axisScale+","+Math.round(n.scale*this.axisScale+Number.EPSILON)/this.axisScale,10,50))},d.prototype.drawCod=function(t,e,n,i){const{x:s,y:o,scale:r}=n;var a=i.canvas.clientWidth,l=i.canvas.clientHeight,h=(t-s)*r+a/2,c=(e-o)*r+l/2;let u=!1;function d(t){return+parseFloat(t).toFixed(2)}(h<5||h>a-19||c>l-28||c<14)&&(u=!0),h<5&&(h=5),c<14&&(c=14),h>a-19&&(h=a-19),c>l-28&&(c=l-28),i.font="14px Verdana",i.fillStyle="rgb(0, 0, 0, 1.0)";let p="",f=d(t/this.axisScale),g=d(-e/this.axisScale);f&&(p+=f),g&&(p+=g),g||f||u||(p+="0"),i.fillText(p,h+5,c+14)},d.prototype.line=function(t,e,n,i,s){this.context.lineWidth=1,this.context.moveTo(t,e),this.context.lineTo(t+n,e+i),this.context.strokeStyle=s,this.context.stroke()};const p=d;function f(){}function g(){this._entities=new Set,this._components=new Map}function m(t){this.context=t,this.scale=100}g.prototype.create=function(){var t=this.make_entity();return this._entities.add(t),this._components.set(t,new Map),t},g.prototype.make_entity=function(){return new f},g.prototype.alive=function(t){return this._entities.has(t)},g.prototype.destroy=function(t){this._components.delete(t),this._entities.delete(t)},g.prototype.asign=function(t,e){if(!e)throw Error("Can't asign to "+e);if(!(e instanceof f))throw Error(e+" is not Entity");var n=this._components.get(e);if(!n)throw Error(e+" not Entity form this set");var i=n.get(t.constructor.name);if(i){if(i&&n.get(t.constructor.name).has(t))throw Error("Component is allready asiged");i.add(t)}else this._components.get(e).set(t.constructor.name,new Set([t]))},g.prototype.get=function(t,e){var n=this._components.get(e);if(!n)return[];var i=n.get(t.name);return i?Array.from(i):[]},g.prototype.remove=function(t,e){var n=this._components.get(e);if(n){var i=n.get(t.constructor.name);i&&i.delete(t)}},g.prototype.getEnities=function(t){return[...this._entities.values()].filter((e=>e&&this.get(t,e).length))},m.prototype.draw=function(t,e,n){const{context:i}=this;var s=i.canvas.clientWidth,o=i.canvas.clientHeight;const{x:r,y:a,scale:l}=t,h=s/2,c=o/2;var u=(-r*l+h)%2;i.beginPath(),i.moveTo(d,0);for(var d=u;d<=s;d+=2){var p=(-e(((d-h)/l+r)/this.scale)*this.scale-a)*l+c;isNaN(p)||(p>o+5&&(p=o+5),p<-5&&(p=-5),i.lineTo(d,p))}i.lineWidth=2,i.strokeStyle=n||"rgba(0, 0, 0, 1)",i.stroke()};const y=m;function x(){const t=[...arguments];if(Array.call(this),1==t.length){var e=Object.values(t[0]);this.push(...e)}else this.push(...Object.values(t));Object.defineProperty(this,"x",{get(){return this[0]},set(t){this[0]=t}}),Object.defineProperty(this,"y",{get(){return this[1]},set(t){this[1]=t}}),Object.defineProperty(this,"z",{get(){return this[2]},set(t){this[2]=t}}),Object.defineProperty(this,"length",{enumerable:!1,writable:!0})}function v(t){this.positions=new x(t)}function w(t,e){this.x=t,this.y=e}function b(t){this.radius=t}function T(t,e){this.font=t,this.text=e}function k(t){this.image=t}function S(t){this.radius=t}function C(t){this.rotate=t}function P(){this.noscale=!0}function E(t){this.scale=t}function O(t,e,n){this.image=t,this.x=e,this.y=n}function N(){}function _(t){this.to=t}function L(t,e,n){this.color=t,this.stroke=e,this.layer=n||0}function M(t,e){this.context=t,this.manager=e,this.maxSize=100}function j(t,e){e.color&&(t.fillStyle=e.color,t.fill()),e.stroke&&(t.strokeStyle=e.stroke.color,t.lineWidth=e.stroke.width,t.stroke())}function W(t,e,n,i,s,o){t.moveTo(e,n+o),t.lineTo(e,n+s-o),t.arcTo(e,n+s,e+o,n+s,o),t.lineTo(e+i-o,n+s),t.arcTo(e+i,n+s,e+i,n+s-o,o),t.lineTo(e+i,n+o),t.arcTo(e+i,n,e+i-o,n,o),t.lineTo(e+o,n),t.arcTo(e,n,e,n+o,o)}function D(t,e){return Math.tanh(6*t-4)+Math.tanh(3*-t+4.3)*(1-e)+Math.tanh(4.3-t)*e}x.from=function(t){return new x(t)},x.prototype.x=0,x.prototype.y=0,x.prototype.z=0,x.prototype=Object.create(Array.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),x.prototype.add=function(t){let e=this.copy();for(var n in e)Object.hasOwnProperty.call(t,n)&&(e[n]+=t[n]);return e},Object.defineProperty(x.prototype,"add",{enumerable:!1}),x.prototype.update=function(t){let e=Object.entries(t);for(var n=0;n<e.length;n++){let t=e[n];Object.hasOwnProperty.call(this,t[0])&&(this[n]=t[1])}},Object.defineProperty(x.prototype,"update",{enumerable:!1}),x.prototype.negate=function(){let t=this.copy();for(var e in this)t[e]=-t[e];return t},Object.defineProperty(x.prototype,"negate",{enumerable:!1}),x.prototype.substract=function(t){return this.add(t.negate())},Object.defineProperty(x.prototype,"substract",{enumerable:!1}),x.prototype.magnitude=function(){let t=0;for(var e of this)t+=e*e;return Math.sqrt(t)},Object.defineProperty(x.prototype,"magnitude",{enumerable:!1}),x.prototype.normalise=function(t){let e=this.magnitude();return e?this.scale(1/e):this.scale(0)},Object.defineProperty(x.prototype,"normalise",{enumerable:!1}),x.prototype.scale=function(t){let e=this.copy();for(var n in this)e[n]*=t;return e},Object.defineProperty(x.prototype,"scale",{enumerable:!1}),x.prototype.copy=function(){return new x(this)},Object.defineProperty(x.prototype,"copy",{enumerable:!1}),N.render=function(t,e,n,i,s){for(let o=0;o<n;o+=s)for(let r=0;r<e;r+=i){let a=Math.min(i,e-r),l=Math.min(s,n-o);this.context.drawImage(t,r,o,a,l)}},M.prototype.draw=function(t){const{context:e}=this;var n=e.canvas.clientWidth,i=e.canvas.clientHeight;const{x:s,y:o,scale:r,angle:a}=t,l=n/2,h=i/2,c=this.maxSize*r;a&&(e.save(),e.translate(l,h),e.rotate(a),e.translate(-l,-h));let u=this.manager.getEnities(L).map((t=>[t,this.manager.get(L,t)[0]])),d=new Map(u.map((([t])=>{var e=this.manager.get(v,t).reduce(((t,e)=>(t[0]+=e.positions[0],t[1]+=e.positions[1],t)),[0,0]);return[t,{x:(e[0]-s)*r+l,y:(e[1]-o)*r+h}]})));u.sort((([,t],[,e])=>t.layer<e.layer?-1:t.layer>e.layer?1:0)).map((([t,s])=>{let{x:o,y:a}=d.get(t);if(o<-c||a<-c||o>n||a>i)return;let l=this.manager.get(P,t)[0],h=this.manager.get(E,t)[0],u=l?1:r*(h?.scale||1),p=this.manager.get(b,t);for(let t in p){let n=p[t];const i=n.radius*u>1?n.radius*u:1;e.beginPath(),e.arc(o,a,i,0,2*Math.PI,!1),j(e,s)}let f=this.manager.get(w,t),g=this.manager.get(_,t),m=this.manager.get(S,t),y=this.manager.get(C,t)[0];for(let t in g){let n=g[t];if(!d.has(n.to))continue;let i=d.get(n.to);e.beginPath(),e.moveTo(o,a),e.lineTo(i.x,i.y),e.closePath(),j(e,s)}for(let t in f){let n=f[t];const i=n.x*u>1?n.x*u:1,r=n.y*u>1?n.y*u:1;e.save(),y&&(e.translate(o+i/2,a+r/2),e.rotate(y.rotate),e.translate(-o-i/2,-a-r/2)),e.beginPath(),m[0]?W(e,o,a,i,r,m[0].radius):e.rect(o,a,i,r),j(e,s),e.restore()}let x=this.manager.get(k,t);for(let t in x){let n=x[t],i=f[0],s=i?.x||n.image.width,r=i?.y||n.image.height;const l=s*u>1?s*u+.5:1,h=r*u>1?r*u+.5:1;e.save(),y&&(e.translate(o+l/2,a+h/2),e.rotate(y.rotate),e.translate(-o-l/2,-a-h/2)),e.drawImage(n.image,o,a,l,h),e.restore()}this.manager.get(O,t).forEach((t=>{let n=f[0],i=n?.x||t.image.width,s=n?.y||t.image.height;const r=i*u>1?i*u+.5:1,l=r/i,h=s*u>1?s*u+.5:1;e.save(),y&&(e.translate(o+r/2,a+h/2),e.rotate(y.rotate),e.translate(-o-r/2,-a-h/2)),e.translate(o,a),N.render.call(this,t.image,r,h,t.x*l,t.y*l,e),e.restore()}));let v=this.manager.get(T,t);for(let t in v){let n=v[t];const i=n.font*u>1?n.font*u:1;e.fillStyle=s.color,e.font=parseInt(i)+"px serif",e.save(),y&&(e.translate(o,a),e.rotate(y.rotate),e.translate(-o,-a)),e.fillText(n.text,o,a+parseInt(i)),e.restore()}})),a&&e.restore()},M.prototype.mesure=function(t){const{context:e}=this;return e.font=parseInt(t.font)+"px serif",e.measureText(t.text)};class z{constructor(t,e){this.func=t=>t,this.trailProb=.05,this.taskNumber=6,this.perfectTask={},this.draw=t,this.input=e;let n=new g;this.manager=n,this.points=new M(t.context,this.manager),this.entities=[],this.fPloter=new y(t.context),this.perfectTask={};for(let t=0;t<200;t++)this.perfectTask[t]=D(t/10,0);this.normalizeTask(this.perfectTask),this.init()}addPoint(t,e,n="#ff0000"){let i=this.manager.create();this.entities.push(i);let s=new v([100*t,100*e]);return this.manager.asign(s,i),this.manager.asign(new b(4),i),this.manager.asign(new L(n,{color:"gray",width:1}),i),i}init(){this.entities.forEach((t=>this.manager.destroy(t))),this.entities=[];let t={};for(let e=0;e<200;e++)t[e]=D(e/10,this.trailProb);this.normalizeTask(t),this.calcFail(t,this.perfectTask,"#ff0000",0);let e=["#ff0000","#00ff00","#0000ff","#00ffff"],n=["#aa4444","#44aa44","#4444aa","#44aaaa"],i=this.combineTwoTasks(t,t),s=this.combineTwoTasks(t,i),o=t,r=this.perfectTask;for(let n=0;n<this.taskNumber;n++)o=this.combineTwoTasks(t,o),r=this.combineTwoTasks(this.perfectTask,r),this.calcFail(o,r,e[n+1]||"#00ffff",n+1);this.plotCumulative(this.perfectTask,"#aa4444"),this.plotChange(this.perfectTask,"#aa4444"),this.plotCumulative(r,n[this.taskNumber]||"#44aaaa"),this.plotChange(r,n[this.taskNumber]||"#44aaaa"),this.plotChange(t),this.plotChange(i,"#00ff00"),this.plotChange(s,"#0000ff"),this.plotChange(o,"#00ffff"),this.plotCumulative(t),this.plotCumulative(i,"#00ff00"),this.plotCumulative(s,"#0000ff"),this.plotCumulative(o,"#00ffff")}plotChange(t,e){let n=this.normCurves?-2/Math.max(...Object.values(t)):-1;for(let i=0;i<200;i++)this.addPoint(i/10,n*(t[i]||0),e)}plotCumulative(t,e){let n=0;for(let i=0;i<200;i++)n+=(t[i]||0)/20*2,this.addPoint(i/10,-3-n,e)}combineTwoTasks(t,e){let n={};for(let i=0;i<100;i++)for(let s=0;s<200;s++){let o=i+s,r=t[i]*e[s]/14;n[o]=n[o]?n[o]+r:r}return this.normalizeTask(n),n}normalizeTask(t){let e=0;for(let n=0;n<200;n++)e+=t[n];e/=20;for(let n=0;n<200;n++)t[n]/=e}setNormCurves(t){this.normCurves=t,this.init()}calcFail(t,e,n,i){let s=0,o=0,r=0;for(let n=0;n<200;n++){o+=e[n],r+=t[n];let i=o-r;i>.001&&(s+=i)}let a=this.addPoint(1+i,-2.7,n);this.manager.asign(new P,a),this.manager.asign(new T(15,"%"+(2*s/20).toFixed(2)),a)}setTask(t){let e=parseFloat(t);isFinite(e)&&(this.taskNumber=e,this.init())}setTail(t){let e=parseFloat(t);isFinite(e)&&(this.trailProb=e/100,this.init())}work(t){this.points.draw(t)}}function $(t,e){x.call(this),this.push(0,0,1,0),this.screen=t,Object.assign(this,e||{}),Object.defineProperty(this,"scale",{get(){return this[2]},set(t){this[2]=t}}),Object.defineProperty(this,"angle",{get(){return this[3]},set(t){this[3]=t}})}function A(){this.isSelected=!1,this.index=0}$.prototype=Object.create(x.prototype),$.prototype.zoom=function(t,e,n){if(this.scale*=t,!isNaN(this.minScale)&&this.scale<this.minScale)this.scale=this.minScale;else if(!isNaN(this.maxScale)&&this.scale>this.maxScale)this.scale=this.maxScale;else if(void 0!==e&&void 0!==n){let i=t-1,s=(this.screen.width/2-e)*i,o=(this.screen.height/2-n)*i;this.move(s,o)}},$.prototype.rotate=function(t){this.angle+=t,this.saveToLocalStorage()},$.prototype.move=function(t,e){let n=t/this.scale,i=e/this.scale;this.x-=n,this.y-=i,!isNaN(this.minX)&&this.x<this.minX&&(this.x=this.minX),!isNaN(this.maxX)&&this.x>this.maxX&&(this.x=this.maxX),!isNaN(this.minY)&&this.y<this.minY&&(this.y=this.minY),!isNaN(this.maxY)&&this.y>this.maxY&&(this.y=this.maxY),this.saveToLocalStorage()},$.prototype.loadFromLocalStorage=function(t){this.localStorageKey=t;let e=localStorage.getItem(this.localStorageKey);if(e){let t=JSON.parse(e);this[0]=t[0]||0,this[1]=t[1]||0,this[2]=t[2]||1,this[3]=t[3]||0}},$.prototype.saveToLocalStorage=function(){this.localStorageKey&&localStorage.setItem(this.localStorageKey,JSON.stringify(this))};const F=(t,e,n,i,s,o,r)=>{let a=t.create();return t.asign(new v([e,n]),a),t.asign(new w(i,s),a),t.asign(new L(o,r),a),t.asign(new S(5),a),a};function X(t,e){let n=t.split(/\r?\n/),i=[];for(let t of n){if(t.length<e){i.push(t);continue}let n=t.split(" "),s="";for(let t of n)t.length>e&&(t=t.slice(0,e-4),t+="..."),s.length+t.length>e&&(i.push(s.slice(1)),s=""),s+=" "+t;s.length&&i.push(s.slice(1))}return i}function Y(){}function H(t,...e){e.forEach((e=>t.asign(new Y,e)))}function I(t){this.checked=t}class J{}class R{constructor(t){this.ploter=t,this.manager=new g,this.render=new M(this.ploter.context,this.manager),this.input_position=new $(t.canvas),this.stabilex=30,this.stabiley=30,this.inputs={},this.baloonText=""}getWith(){return this.ploter.canvas.width}getHeight(){return this.ploter.canvas.height}setResolution(){this.input_position.x=this.getWith()/2,this.input_position.y=this.getHeight()/2}touchClick({x:t,y:e}){var n=this.ploter.screenToWorld(this.input_position,[t,e]);const i=this.manager.getEnities(A).map((t=>{var e=this.manager.get(v,t)[0],n=this.manager.get(w,t)[0],i=this.manager.get(A,t)[0];return i.index=0,{transform:e,box:n,selectable:i,id:t}})).filter((({transform:t,box:e})=>function(t,e,n){return!(t[0]>n[0]||t[1]>n[1]||t[0]+e[0]<n[0]||t[1]+e[1]<n[1])}(t.positions,[e.x,e.y],n)))[0];if(i){let t=this.manager.get(I,i.id)[0];t&&this.setState(i.id,!t.checked)}return i}addTogle(t){let e=new T(20,t),n=this.render.mesure(e).width,i=this.manager.create();this.manager.asign(new v([this.stabilex,this.stabiley]),i),this.manager.asign(new w(n+10,30),i),this.manager.asign(new L("#555555"),i),this.manager.asign(new A,i),this.manager.asign(new I(!1),i),this.all.push(i);let s=this.manager.create();return this.manager.asign(new v([this.stabilex+5,this.stabiley]),s),this.manager.asign(e,s),this.manager.asign(new L("#cccccc"),s),this.all.push(s),this.stabilex+=n+15,this.inputs[t]=i,i}getCheckedByText(t){if(!this.inputs[t])return!1;let e=this.manager.get(I,this.inputs[t])[0];return!!e&&e.checked}setState(t,e){let n=this.manager.get(L,t)[0];n&&(n.color=e?"#888888":"#555555");let i=this.manager.get(I,t)[0];i&&(i.checked=e)}setBaloonText(t){if(this.baloonText==t)return;if(this.baloonText=t,this.manager.getEnities(J).forEach((t=>{this.manager.destroy(t)})),!this.baloonText)return;let e=function(t,e,n,i,s){let o=[],r=s?.textSize||20,a=s?.lineHeight||r+10,l=s?.background||"#ffffffaa",h=s?.borderColor||"#ffffff",c=s?.borderWidth||1,u=s?.anchor||[0,0],d=s?.paddingX||s?.padding||10,p=s?.paddingY||s?.padding||10,f=s?.minWidth||0,g=s?.minHeight||0,m=s?.maxWidth||0,y=0,x=i.split(/\r?\n/).map((t=>{let n=new T(r,t),i=e.mesure(n).width,s=i+2*d;if(!m||s<m)return y=Math.max(i,y),[n];for(let n=t.length-1;0<n;n--){let i=X(t,n).map((t=>new T(r,t))),o=i.map((t=>e.mesure(t).width));if(s=Math.max(...o.map((t=>t+2*d))),s<m)return y=Math.max(y,...o),i}return[n]}));x=x.flat();let w=y+2*d;w=Math.max(f,w);let b=x.length*a+2*p;b=Math.max(g,b);let k=n[0]-w*u[0],S=n[1]-b*u[1],C=((t,e,n,i,s,o,r)=>{let a=r.width-1,l=F(t,e-a,n-a,i+2*a,s+2*a,null,{...r,width:a+2});return[F(t,e,n,i,s,o),l]})(t,k,S,w,b,l,{color:h,width:c});return o.push(...C),H(t,...C),x.map(((e,n)=>{let i=t.create();t.asign(new v([k+d,S+p+n*a]),i),t.asign(e,i),t.asign(new L("#000000",null,2),i),o.push(i),H(t,i)})),o}(this.manager,this.render,[this.getWith()-126,this.getHeight()-30],this.baloonText,{textSize:20,maxWidth:this.getWith()-136,minWidth:this.getWith()-136,anchor:[1,1],borderColor:"#aaaaaa",background:"#aaaaaaaa"});e.map((t=>this.manager.asign(new J,t)))}work(){this.render.draw(this.input_position)}}var Z=n(296),B=n.n(Z);let q;class K extends HTMLElement{constructor(){if(super(),q)throw new Error(".floating-window already created");const t=this.attachShadow({mode:"open"}),e=document.createElement("div");e.classList.add("floating-window");const n=document.createElement("style");n.textContent="\n      .floating-window {\n        position: absolute;\n        top: 10px;\n        left: 10px;\n        width: 300px;\n        padding: 10px;\n        background-color: rgba(255, 255, 255, 0.3);\n        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n        border-radius: 8px;\n      }\n    ",t.appendChild(n),t.appendChild(e),q=e,document.body.appendChild(this)}}class V extends HTMLElement{constructor(t){super();const e=this.attachShadow({mode:"open"});q||new K;const n=document.createElement("style");n.textContent="\n      .slider-container {\n        margin-bottom: 15px;\n        display: flex;\n        align-items: center;\n      }\n      .slider-label {\n        width: 80px; /* Fixed width for all labels */\n        margin-right: 10px;\n        font-weight: bold;\n        text-align: right; /* Align text to the right */\n      }\n      .slider {\n        flex: 1;\n        margin-right: 10px;\n      }\n      output {\n        text-align: right;\n        min-width: 20px;\n      }\n    ",e.appendChild(n);const i=function({label:t,id:e,defaultValue:n,oninput:i,min:s,max:o}){const r=document.createElement("div");if(r.classList.add("slider-container"),t){const n=document.createElement("label");n.classList.add("slider-label"),n.setAttribute("for",e),n.textContent=t,r.appendChild(n)}const a=document.createElement("input");a.type="range",e&&(a.id=e),a.classList.add("slider"),a.min=s||"0",a.max=o||"20",a.value=n||0;const l=document.createElement("output");return l.textContent=n||0,a.oninput=function(){l.value=a.value,i&&i(a.value)},r.appendChild(a),r.appendChild(l),r}(t);e.appendChild(i),q.appendChild(this)}}class U extends HTMLElement{constructor(t){super();const e=this.attachShadow({mode:"open"});q||new K;const n=document.createElement("style");n.textContent="\n      .checkbox-container {\n        margin-bottom: 15px;\n        display: flex;\n        align-items: center;\n      }\n      .checkbox-label {\n        width: 80px; /* Fixed width for all labels */\n        margin-right: 10px;\n        font-weight: bold;\n        text-align: right; /* Align text to the right */\n      }\n      .checkbox {\n        margin-right: 10px;\n      }\n    ",e.appendChild(n);const i=function({label:t,id:e,checked:n,onchange:i}){const s=document.createElement("div");if(s.classList.add("checkbox-container"),t){const n=document.createElement("label");n.classList.add("checkbox-label"),n.setAttribute("for",e),n.textContent=t,s.appendChild(n)}const o=document.createElement("input");return o.type="checkbox",e&&(o.id=e),o.classList.add("checkbox"),o.checked=n||!1,o.onchange=function(){i&&i(o.checked)},s.appendChild(o),s}(t);e.appendChild(i),q.appendChild(this)}}customElements.define("checkbox-component",U),customElements.define("slider-component",V),customElements.define("floating-window",K);const G=document.getElementById("phy_canvas");let{work:Q,adjustWindowSize:tt}=function(t,e){var n=new u(t),i=new R(n),s=new $(t,{minX:-2e3,minY:-2e3,maxX:2e3,maxY:2e3,minScale:.15,maxScale:3});s.loadFromLocalStorage("mylastview");var o=new z(n,i);let r=B()(o.setTail.bind(o),200);new V({label:"Tail %",defaultValue:"6",max:"50",oninput:r});let l=B()(o.setTask.bind(o),200);new V({label:"Tasks NO",defaultValue:"6",max:"10",oninput:l});let h=B()(o.setNormCurves.bind(o),200);new U({label:"Normalize Curves",onchange:h});var c=new a(t,20);c.throw_error=!0,window.addEventListener("mousewheel",(function(t){s.zoom(t.wheelDelta>0?1.1:.88,c.centerPosition.x,c.centerPosition.y)})),document.addEventListener("contextmenu",(function(t){t.preventDefault()}));const d=new p(n.context,{axisCords:!0,devide:4,showAxis:!1});let f=!1,g=!1;return c.onForce((t=>{var{delta:e,deltaZoom:n,isPrimary:i,centerPosition:o,position:r,isClick:a}=t;1!=n&&s.zoom(n,o.x,o.y),s.move(e.x,e.y)})),c.onStop((t=>{f=!1,g=!1})),c.onClick((t=>{i.touchClick(t)})),{work:function(){n.clear(),d.draw(100,100,s),o.work(s),i.work()},adjustWindowSize:function(){i.setResolution()}}}(G);window.addEventListener("resize",(()=>{G.width=window.innerWidth-10,G.height=window.innerHeight-10,tt()})),G.width=window.innerWidth-10,G.height=window.innerHeight-10,tt();let et=()=>{Q(),setTimeout(et,0)};et()})()})();